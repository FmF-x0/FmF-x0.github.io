<!DOCTYPE html> <html lang="en-US"> <head prefix="og: http://ogp.me/ns#"> <meta charset="UTF-8" /> <meta http-equiv="X-UA-Compatible" content="ie=edge" /> <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <meta name="mobile-web-app-capable" content="yes" /> <meta name="apple-mobile-web-app-capable" content="yes" /> <meta name="application-name" content="FmF" /> <meta name="apple-mobile-web-app-status-bar-style" content="#fff" /> <meta name="apple-mobile-web-app-title" content="FmF" /> <title> Santa&#39;s List (Parrot CTF) - FmF </title> <link rel="alternate" href="http://localhost:4000/ParrotCtf-Santas_List/" hreflang="en-US" /> <link rel="canonical" href="http://localhost:4000/ParrotCtf-Santas_List/" /> <meta name="description" content="This is a personal blog about a hacking and other stuff." /> <meta name="referrer" content="no-referrer-when-downgrade" /> <meta property="fb:app_id" content="" /> <meta property="og:site_name" content="Santa&#39;s List (Parrot CTF) | FmF" /> <meta property="og:title" content="Santa&#39;s List (Parrot CTF) | FmF" /> <meta property="og:type" content="website" /> <meta property="og:url" content="http://localhost:4000/ParrotCtf-Santas_List/" /> <meta property="og:description" content="This is a personal blog about a hacking and other stuff." /> <meta property="og:image" content="http://localhost:4000/ParrotCtf-Santas_List/banner.png" /> <meta property="og:image:width" content="640" /> <meta property="og:image:height" content="640" /> <meta name="twitter:card" content="summary" /> <meta name="twitter:title" content="Santa&#39;s List (Parrot CTF) | " /> <meta name="twitter:url" content="http://localhost:4000/ParrotCtf-Santas_List/" /> <meta name="twitter:site" content="@" /> <meta name="twitter:creator" content="@" /> <meta name="twitter:description" content="This is a personal blog about a hacking and other stuff." /> <meta name="twitter:image" content="http://localhost:4000/ParrotCtf-Santas_List/banner.png" /> <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="FmF" /> <link rel="apple-touch-icon" sizes="180x180" href="/assets/favicons/apple-touch-icon.png" /> <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png" /> <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png" /> <link rel="manifest" href="/assets/favicons/site.webmanifest" /> <link rel="mask-icon" href="/assets/favicons/safari-pinned-tab.svg" color="#5bbad5" /> <meta name="apple-mobile-web-app-title" content="Jekyll Klise" /> <meta name="application-name" content="Jekyll Klise" /> <meta name="msapplication-TileColor" content="#da532c" /> <meta name="theme-color" content="#2c2c2c" /> <link rel="stylesheet" href="/assets/css/style.css" /> <!-- for mathjax support --> </head> <body data-theme="dark" class="notransition"> <script> const body = document.body; const data = body.getAttribute("data-theme"); const initTheme = (state) => { if (state === "dark") { body.setAttribute("data-theme", "dark"); } else if (state === "light") { body.removeAttribute("data-theme"); } else { localStorage.setItem("theme", data); } }; initTheme(localStorage.getItem("theme")); setTimeout(() => body.classList.remove("notransition"), 75); </script> <div class="navbar" role="navigation"> <nav class="menu"> <input type="checkbox" id="menu-trigger" class="menu-trigger" /> <label for="menu-trigger"> <span class="menu-icon"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <path d="M64,384H448V341.33H64Zm0-106.67H448V234.67H64ZM64,128v42.67H448V128Z" /> </svg> </span> </label> <a id="mode"> <svg class="mode-sunny" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <title>LIGHT</title> <line x1="256" y1="48" x2="256" y2="96" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="256" y1="416" x2="256" y2="464" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="108.92" x2="369.14" y2="142.86" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="369.14" x2="108.92" y2="403.08" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="464" y1="256" x2="416" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="96" y1="256" x2="48" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="403.08" x2="369.14" y2="369.14" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="142.86" x2="108.92" y2="108.92" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <circle cx="256" cy="256" r="80" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> </svg> <svg class="mode-moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <title>DARK</title> <line x1="256" y1="48" x2="256" y2="96" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="256" y1="416" x2="256" y2="464" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="108.92" x2="369.14" y2="142.86" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="369.14" x2="108.92" y2="403.08" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="464" y1="256" x2="416" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="96" y1="256" x2="48" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="403.08" x2="369.14" y2="369.14" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="142.86" x2="108.92" y2="108.92" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <circle cx="256" cy="256" r="80" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> </svg> </a> <div class="trigger"> <div class="trigger-container"><a class="menu-link" href="/">Home</a><a class="menu-link" href="/archive/">Archive</a><a class="menu-link" href="/about/">About</a></a> </div> </div> </nav> </div> <div class="wrapper post"> <main class="page-content" aria-label="Content"> <article itemscope itemtype="https://schema.org/BlogPosting"> <header class="header"> <div class="tags"> <span itemprop="keywords"> <a class="tag" href="/tags/#unix-linux">UNIX/LINUX</a>, <a class="tag" href="/tags/#parrot-ctf">PARROT CTF</a> </span> </div> <h1 class="header-title" itemprop="headline">Santa&#39;s List (Parrot CTF)</h1> <div class="post-meta"> <time datetime="2023-08-30T05:00:00+00:00" itemprop="datePublished"> Aug 30, 2023 </time> <span itemprop="author" itemscope itemtype="https://schema.org/Person"> <span itemprop="name">FmF</span> </span> <time hidden datetime="" itemprop="dateModified"> Aug 30, 2023 </time> <span hidden itemprop="publisher" itemtype="Person">FmF</span> <span hidden itemprop="image">/ParrotCtf-Santas_List/banner.png</span> <span hidden itemprop="mainEntityOfPage"><p><img src="/ParrotCtf-Santas_List/images/1.jpg" alt="Pwned, lol" /></p> </span> </div> </header> <div class="page-content" itemprop="articleBody"> <p><img src="/ParrotCtf-Santas_List/images/1.jpg" alt="Pwned, lol" /></p> <p>ü¶ú <a href="https://parrot-ctfs.com/">Parrot CTFs</a> is an advanced cybersecurity education platform and capture the flag provider. Their goal is to create the most realistic capture the flag challenges and demonstrate real-world attack scenarios.</p> <p>Thanks to <a><code class="language-plaintext highlighter-rouge">parrotassassin15</code></a> for the help üíñ.</p> <h2 id="content"> <a href="#content" class="anchor-head"></a> Content: </h2> <ul> <li><a href="#enumeration-">Enumeration</a></li> <li><a href="#initial-access-">Initial access</a></li> <li><a href="#privilege-escalation-">Privilege escalation</a></li> </ul> <h2 id="enumeration-"> <a href="#enumeration-" class="anchor-head"></a> Enumeration üîé: </h2> <p>We start by using <code class="language-plaintext highlighter-rouge">ping</code> to check the <em>TTL</em> of the machine to determine the OS we are dealing with.</p> <p><img src="/ParrotCtf-Santas_List/images/2.png" /></p> <p>Based on the <em>TTL</em> value of 63, we can determine that the machine is running a Linux machine. However, this is not for sure, but it gives us an idea. For more information, you can view: <a href="https://ostechnix.com/identify-operating-system-ttl-ping/">Identify OS using TTL value</a>.</p> <p>Now, let‚Äôs go with an <code class="language-plaintext highlighter-rouge">nmap</code> scan to view the open ports.</p> <p><code class="language-plaintext highlighter-rouge">sudo nmap -p- --open -sS --min-rate 5000 -n -v -Pn 10.14.0.9 -oN allPorts</code></p> <p><code class="language-plaintext highlighter-rouge">-p-</code> ‚Äì&gt; We are doing a scan against all 65535 ports to search for open ports.</p> <p><code class="language-plaintext highlighter-rouge">--open</code> ‚Äì&gt; It will only report open ports.</p> <p><code class="language-plaintext highlighter-rouge">-sS</code> ‚Äì&gt; It can be performed quickly, scanning thousands of ports per second.</p> <p><code class="language-plaintext highlighter-rouge">--min-rate 5000</code> ‚Äì&gt; It sets the minimum rate of packets sent per second to 5000.</p> <p><code class="language-plaintext highlighter-rouge">-n</code> ‚Äì&gt; Tells Nmap to never do reverse DNS resolution on the active IP addresses it finds.</p> <p><code class="language-plaintext highlighter-rouge">-v</code> ‚Äì&gt; It will be verbose in its output.</p> <p><code class="language-plaintext highlighter-rouge">-Pn</code> ‚Äì&gt; This option skips the host discovery stage.</p> <p><code class="language-plaintext highlighter-rouge">-oN</code> ‚Äì&gt; It will save the output in a file called ‚ÄúallPorts‚Äù.</p> <p>We find out the following open ports:</p> <p><img src="/ParrotCtf-Santas_List/images/3.png" /></p> <p>Let‚Äôs take a look at what the page has.</p> <p><img src="/ParrotCtf-Santas_List/images/4.png" /></p> <p>We can see a login panel that has some information that we can use. The login panel says <code class="language-plaintext highlighter-rouge">Santa's administration panel</code>, so maybe a valid username can be <a><code class="language-plaintext highlighter-rouge">santa</code></a>.</p> <h2 id="initial-access-"> <a href="#initial-access-" class="anchor-head"></a> Initial access üîë: </h2> <p>We can try common credentials like <code class="language-plaintext highlighter-rouge">admin:admin</code> or <code class="language-plaintext highlighter-rouge">root:root</code> and many others‚Ä¶ But let‚Äôs try with the information that we have <code class="language-plaintext highlighter-rouge">santa:santa</code>, <code class="language-plaintext highlighter-rouge">santa:admin</code> or <a><code class="language-plaintext highlighter-rouge">santa:northpole</code></a> and with those credentials, we can gain access‚Ä¶</p> <p>But let‚Äôs try other ways rather than guessing. For example, we can use the tool <code class="language-plaintext highlighter-rouge">cewl</code> to create a wordlist based on the content of the page.</p> <p><code class="language-plaintext highlighter-rouge">cewl http://10.14.0.9/ --lowercase -w wordlist.txt</code></p> <p><img src="/ParrotCtf-Santas_List/images/5.png" /></p> <p>We can use the tool <a href="https://www.hackingarticles.in/comprehensive-guide-on-cupp-a-wordlist-generating-tool/"><code class="language-plaintext highlighter-rouge">cupp</code></a> to generate different variations of words.</p> <p><code class="language-plaintext highlighter-rouge">./cupp -w wordlist.txt</code> ‚Äì&gt; We pass the wordlist that we created with <code class="language-plaintext highlighter-rouge">cewl</code>.</p> <p><img src="/ParrotCtf-Santas_List/images/6.png" /></p> <p>The content of the <code class="language-plaintext highlighter-rouge">wordlist.txt.cupp.txt</code> file generated by <code class="language-plaintext highlighter-rouge">cupp</code> is as follows:</p> <p><img src="/ParrotCtf-Santas_List/images/7.png" /></p> <p>We can see that it generates a lot of variations.</p> <p>Now let‚Äôs do a bruteforce attack with the use of wordlist that we have and let‚Äôs try with the username <code class="language-plaintext highlighter-rouge">santa</code>.</p> <p>There are many ways to complete a bruteforce attack. We will use the tool <a href="https://infinitelogins.com/2020/02/22/how-to-brute-force-websites-using-hydra/"><code class="language-plaintext highlighter-rouge">hydra</code></a> in this case.</p> <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">hydra</span> <span class="o">-</span><span class="n">l</span> <span class="n">santa</span> <span class="o">-</span><span class="no">P</span> <span class="n">wordlist</span><span class="p">.</span><span class="nf">txt</span><span class="p">.</span><span class="nf">cupp</span><span class="p">.</span><span class="nf">txt</span> <span class="mf">10.14</span><span class="o">.</span><span class="mf">0.9</span> <span class="n">http</span><span class="o">-</span><span class="n">post</span><span class="o">-</span><span class="n">form</span> <span class="s2">"/index.php:username=santa&amp;password=^PASS^:Incorrect login"</span> <span class="o">-</span><span class="n">v</span>
</code></pre></div></div> <p><img src="/ParrotCtf-Santas_List/images/8.png" /></p> <p>And the correct credentials are <a><code class="language-plaintext highlighter-rouge">santa:northpole</code></a>.</p> <p><img src="/ParrotCtf-Santas_List/images/9.png" /></p> <p>We are in and we can see a button to download a file.</p> <p><img src="/ParrotCtf-Santas_List/images/10.png" /></p> <p>We can see a new username: <a><code class="language-plaintext highlighter-rouge">elf-manager</code></a>. Maybe we can use it to login with SSH.</p> <p>But let‚Äôs first decrypt the MD5 hashes with <a href="https://md5decrypt.net/en/"><code class="language-plaintext highlighter-rouge">md5decrypt.net</code></a>.</p> <p><img src="/ParrotCtf-Santas_List/images/11.png" /></p> <p>What if we try reusing the password <a><code class="language-plaintext highlighter-rouge">northpole</code></a> with the username <a><code class="language-plaintext highlighter-rouge">elf-manager</code></a>? We can try to connect to SSH and see if we can get in.</p> <p><img src="/ParrotCtf-Santas_List/images/12.png" /></p> <p>It works üéâ. Now that we are inside the machine you need to do some things to ensure smooth operation:</p> <ol> <li><code class="language-plaintext highlighter-rouge">export TERM=xterm</code></li> </ol> <p>This will allow us to clean the screen with <code class="language-plaintext highlighter-rouge">ctrl + l</code>.</p> <p>Now we can see the flag üéâ.</p> <h2 id="privilege-escalation-"> <a href="#privilege-escalation-" class="anchor-head"></a> Privilege escalation üö©: </h2> <p>We need to enumerate the system to find a way to escalate privileges.</p> <p>One thing I always check first is <code class="language-plaintext highlighter-rouge">sudo -l</code>. This command helps us determine if we have the ability to execute commands as other user. If we are lucky, we might discover that we can execute commands with the privileges of the root user.</p> <p>More info about privilege escalation techniques check <a href="https://book.hacktricks.xyz/linux-hardening/privilege-escalation">here.</a></p> <p><img src="/ParrotCtf-Santas_List/images/13.png" /></p> <p>We can execute <code class="language-plaintext highlighter-rouge">vim</code> command as the root user. We can see in <a href="https://gtfobins.github.io/gtfobins/vim/">GTFOBins</a> for a way to escalate privileges.</p> <p>Or we can do it this way:</p> <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sudo</span> <span class="n">vim</span>

<span class="n">esc</span> <span class="o">+</span> <span class="p">:</span> <span class="o">+</span> <span class="o">!</span><span class="n">bash</span> <span class="o">--&gt;</span> <span class="no">This</span> <span class="n">is</span> <span class="n">to</span> <span class="n">spawn</span> <span class="n">a</span> <span class="n">shell</span> <span class="n">as</span> <span class="n">root</span> <span class="n">user</span><span class="o">.</span>
</code></pre></div></div> <p><img src="/ParrotCtf-Santas_List/images/14.png" /></p> <p>And now we are root :)</p> <p><img src="/ParrotCtf-Santas_List/images/15.png" /></p> <p>Hope you like it and learn something new :)</p> </div> </article> </main> <nav class="post-nav"> <a class="post-nav-item post-nav-prev" href="/ParrotCtf-Pet_Shop/" > <div class="nav-arrow">Previous</div> <span class="post-title">Pet shop (Parrot CTF)</span> </a> </nav> <footer class="footer"> <span class="footer_item">&copy; 2023</span> <small class="footer_copyright"> Made with üíñ by FmF. </small> </footer> <script src="/assets/js/main.js" defer="defer"></script> </div> </body> </html>
