<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>Pwnedcr 5</title><!-- Begin Jekyll SEO tag v2.7.1 -->
<meta name="generator" content="Jekyll v3.9.3" />
<meta property="og:title" content="Pwnedcr 5" />
<meta name="author" content="FmF" />
<meta property="og:locale" content="en_US" />
<link rel="canonical" href="http://localhost:4000/pwnedcr-5.html" />
<meta property="og:url" content="http://localhost:4000/pwnedcr-5.html" />
<meta property="og:site_name" content="FmF - Hacking blog ü©ª" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-12-08T00:00:00-06:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Pwnedcr 5" />
<script type="application/ld+json">
{"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/pwnedcr-5.html"},"author":{"@type":"Person","name":"FmF"},"@type":"BlogPosting","url":"http://localhost:4000/pwnedcr-5.html","headline":"Pwnedcr 5","dateModified":"2022-12-08T00:00:00-06:00","datePublished":"2022-12-08T00:00:00-06:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="FmF - Hacking blog ü©ª" /><link rel="shortcut icon" type="image/x-icon" href="/logo.png" />
  <link rel="stylesheet" href="/assets/css/main.css" />
</head><body a="dark">
    <main class="page-content" aria-label="Content">
      <div class="w">
        <a href="/">../</a><article>
  <p class="post-meta">
    <time datetime="2022-12-08 00:00:00 -0600">2022-12-08</time>
  </p>
  
  <h1>Pwnedcr 5</h1>

  <p><img src="/assets/img/pwnedcr5/pwnedcr-5.png" width="800" /></p>

<h3 id="retos">Retos:</h3>

<ul>
  <li>El regalo</li>
  <li>Cryptonita</li>
  <li>Tron</li>
  <li>Enum√©rame</li>
  <li>Bruto el fuerte</li>
  <li>Siete a cero</li>
  <li>Scripteando</li>
</ul>

<h1 id="el-regalo">El regalo:</h1>

<p><img src="/assets/img/pwnedcr5/1.png" width="600" /></p>

<p>Nos dan una cadena de caracteres que se parece a una cadena encodeada en base64.</p>

<p>Sabiendo esto, podemos intentar de decodificarlo desde una terminal de la siguiente manera:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">echo</span> <span class="s2">"UFdORURDUnt2ZW5pbW9zX2VuX3Bhel9naGVpQDkwJCN9"</span> <span class="o">|</span> <span class="n">base64</span> <span class="o">-</span><span class="n">d</span><span class="p">;</span> <span class="n">echo</span>
</code></pre></div></div>
<p>De esta manera obtenemos la flag: <strong>PWNEDCR{venimos_en_paz_ghei@90$#}</strong></p>

<p>De una manera alternativa podemos ir a la siguiente pagina <a href="https://www.base64decode.org/" title="Base64 decoder">Link</a> y pegamos nuestra cadena para decodificarla.</p>

<h1 id="cryptonita">Cryptonita:</h1>

<p><img src="/assets/img/pwnedcr5/2.png" width="600" /></p>

<p>Vemos que esta vez no nos dan una cadena, pero si leemos de manera detenida podemos ver una pista, la cual es: ‚Äúse cree que en √©sta p√°gina se esta intercambiando informaci√≥n‚Äù, esto nos puede decir que la flag puede esta en el codigo fuente de la pagina.</p>

<p>Vamos a ver el codigo fuente y en efecto vemos algo fuera de lo comun casi al final de la pagina, una cadena parecida a la del reto anterior pero esta vez es mucho mas larga.</p>

<p><img src="/assets/img/pwnedcr5/3.png" width="600" /></p>

<p>Vamos a tratar de decodificarlo‚Ä¶</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">echo</span> <span class="s2">"Tm9zIGVzdOFuIHNpZ3VpZW5kbyBlbCByYXN0cm8sIGhheSBxdWUgYm9ycmFyIHRvZGEgaW5mb3JtYWNp824gYW50ZXMgZGUgcXVlIHNlYSBkZW1hc2lhZG8gdGFyZGUsIGxhcyBjdWVudGFzIGVuIGxvcyBvdHJvcyBwYe1zZXMgZnVlcm9uIGJsb3F1ZWFkYXMsIGxvIPpuaWNvIHF1ZSBub3MgcXVlZGEgZXMgZWwgd2FsbGV0IGRlIGNyeXB0byBtb25lZGFzIHF1ZSBzb2xvIHVzdGVkZXMgeSB5byBzYWJlbW9zIGRvbmRlIGVzdOEsIHJlY3VlcmRlbiB1dGlsaXphciBsYSBwYWxhYnJhIGRlIHBhc28gcGFyYSBwb2RlciBzYWJlciBudWVzdHJvIHBy83hpbW8gcHVudG8gZGUgcmV1bmnzbjogW1sgVUZkT1JVUkRVbnR6WldOMGIzSmZORjloY0dGeWRHRnRaVzUwYjE4Mk5WOTZiMjVoWDI1MVkyeGxZWEpmWkdWellXeHZhbUZrWVY4MUpETXlRREY5IF1d"</span> <span class="o">|</span> <span class="n">base64</span> <span class="o">-</span><span class="n">d</span><span class="p">;</span> <span class="n">echo</span>
</code></pre></div></div>

<p><img src="/assets/img/pwnedcr5/4.png" width="600" /></p>

<p>Vemos un mesage curioso y otra cadena que tambien se parece mucho a una cadena en base64, vamos a decodificarla:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">echo</span> <span class="s2">"UFdORURDUntzZWN0b3JfNF9hcGFydGFtZW50b182NV96b25hX251Y2xlYXJfZGVzYWxvamFkYV81JDMyQDF9"</span> <span class="o">|</span> <span class="n">base64</span> <span class="o">-</span><span class="n">d</span><span class="p">;</span> <span class="n">echo</span>
</code></pre></div></div>
<p>Con esto ya podemos ver la flag: <strong>PWNEDCR{sector_4_apartamento_65_zona_nuclear_desalojada_5$32@1}</strong></p>

<h1 id="tron">Tron:</h1>

<p><img src="/assets/img/pwnedcr5/5.png" width="600" /></p>

<p>Vemos que nos dan una pista la cual es: ‚Äúla imagen contiene alg√∫n mensaje‚Äù y con esto ya nos viene a la mente que puede ser un mensaje fue escondido con esteganograf√≠a.</p>

<p>Para analizar la image a un nivel mas bajo podemos utilizar la herramienta: <em>exiftool</em> la cual es una herramienta para ver los metadatos en archivos.</p>

<p>Podemos descargar la imagen y ejecutar el siguiente comando para analizarla.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">exiftool</span> <span class="n">tron</span><span class="p">.</span><span class="nf">png</span>
</code></pre></div></div>

<p>Y en efecto vemos bastante informacion y entre ella la flag:</p>

<p><img src="/assets/img/pwnedcr5/6.png" width="600" /></p>

<h1 id="enum√©rame">Enum√©rame:</h1>

<p><img src="/assets/img/pwnedcr5/7.png" width="600" /></p>

<p>Nos dan esta pista ‚Äúreto4.php?id=123‚Äù ya podemos pensar en un ataque IDOR (Insecure direct object references) lo que podemos hacer es ir iterando entre numeros, 124, 125, 126‚Ä¶etc.</p>

<p>Poniendo 126 en lugar de 123: ‚Äú<code class="language-plaintext highlighter-rouge">https://ctf.pwnedcr.com/retos/reto4.php?id=126</code>‚Äù ya podemos ver la flag:</p>

<p><img src="/assets/img/pwnedcr5/8.png" width="600" /></p>

<h1 id="bruto-el-fuerte">Bruto el fuerte</h1>

<p><img src="/assets/img/pwnedcr5/9.png" width="600" /></p>

<p>Podemos descargar los dos diccionarios que nos proveen ya que los vamos a utilizar.</p>

<p>Presionando ‚ÄúAbrir app‚Äù y nos abre la siguiente ventana:</p>

<p><img src="/assets/img/pwnedcr5/10.png" width="600" /></p>

<p>Nos dan una pista con el titulo ya que se refiere a un ‚Äúataque de fuerza bruta‚Äù.</p>

<p>Con la herramienta <em>hydra</em> podemos hacer el ataque‚Ä¶</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">hydra</span> <span class="o">-</span><span class="no">L</span> <span class="n">top</span><span class="o">-</span><span class="n">usernames</span><span class="o">-</span><span class="n">shortlist</span><span class="p">.</span><span class="nf">txt</span> <span class="o">-</span><span class="no">P</span> <span class="n">rockyou_top</span><span class="o">-</span><span class="mi">1</span><span class="n">k</span><span class="p">.</span><span class="nf">txt</span> <span class="n">ctf</span><span class="p">.</span><span class="nf">pwnedcr</span><span class="p">.</span><span class="nf">com</span> <span class="n">https</span><span class="o">-</span><span class="n">post</span><span class="o">-</span><span class="n">form</span> <span class="s2">"/retos/reto5_login.php:username=^USER^&amp;password=^PASS^:F=ACCESS DENIED"</span>
</code></pre></div></div>

<p>Uso de <em>hydra</em>:</p>

<ul>
  <li>-L ‚Äì&gt; Indicamos que le vamos a pasar un diccionario de <strong>usuarios</strong>.</li>
  <li>-P ‚Äì&gt; Indicamos que le vamos a pasar un diccionario de <strong>contrase√±as</strong>.</li>
  <li>ctf.pwnedcr.com ‚Äì&gt; Es el dominio que vamos a atacar.</li>
  <li>https-post-form ‚Äì&gt; Vamos a enviar un formulario que serian el usuario y contrase√±a.</li>
  <li>/retos/reto5_login.php ‚Äì&gt; La ruta donde se ubica el formulario que vamos a atacar.</li>
  <li>:username=^USER^&amp;password=^PASS^ ‚Äì&gt; Estos son los campos que vamos a atacar con hydra el username y password, para saber si son diferentes nos podemos fijar en la peticion que estamos enviando por burp o tambien lo podemos ver en el codigo fuente.</li>
  <li>:F=ACCESS DENIED ‚Äì&gt; El ‚ÄúACCESS DENIED‚Äù es la palabra que la pagina web nos va a dar si hacemos un intento fallido, el ‚ÄúACCESS DENIED‚Äù lo saque del codigo fuente de la pagina cuando ponemos unas credenciales no validas, lo vemos en la siguiente imagen:</li>
</ul>

<p><img src="/assets/img/pwnedcr5/18.png" width="600" /></p>

<p>Para mas informacion recomiendo buscar en google ;)</p>

<p>Ejecutamos comando anterior en nuestra terminal y obtenemos un username y un password: admin:jordan23</p>

<p>Y obtenemos la flag.</p>

<p><img src="/assets/img/pwnedcr5/17.png" width="600" /></p>

<h1 id="siete-a-cero">Siete a cero:</h1>

<p><img src="/assets/img/pwnedcr5/11.png" width="600" /></p>

<p>Presionando ‚ÄúAbrir app‚Äù y nos abre la siguiente ventana:</p>

<p><img src="/assets/img/pwnedcr5/10.png" width="600" /></p>

<p>Ponemos ‚Äútest‚Äù y ‚Äútest‚Äù y vemos que el output se ve reflejado y pensamos en un ataque xss. (Al principio intente hacer un bypass del login y dure muchas horas y no pude hacer nada y al hacer un xss fue algo irreal.)</p>

<p><img src="/assets/img/pwnedcr5/12.png" width="600" /></p>

<p>Para hacer el ataque xss ponemos: ‚Äú<strong>&lt;script&gt;alert(1)&lt;/script&gt;</strong>‚Äù en la parte del usuario y en la parte del password ponemos lo que querramos.  (‚ÄúTiene que ser exactamente igual por que si variamos auque sea el numero, no nos dara la flag‚Äù)</p>

<p>y con esto conseguimos la flag:</p>

<p><img src="/assets/img/pwnedcr5/13.png" width="600" /></p>

<h1 id="scripteando">Scripteando:</h1>

<p><img src="/assets/img/pwnedcr5/14.png" width="600" /></p>

<p>No hay muchas pistas pero empezamos con un analizis del codigo fuente de la pagina y vemos algo interesante:</p>

<p><img src="/assets/img/pwnedcr5/15.png" width="800" /></p>

<p>Viendo mas esa linea de codigo podemos notar que ahi esta la flag:</p>

<p><img src="/assets/img/pwnedcr5/16.png" width="800" /></p>


</article>
      </div>
    </main>
  </body>
</html>