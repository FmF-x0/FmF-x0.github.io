<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <meta name="description" content="Retos: El regalo Cryptonita Tron Enumérame Bruto el fuerte Siete a cero ScripteandoEl regalo:Nos dan una cadena de caracteres que se parece a una cade..."> <link type="application/atom+xml" rel="alternate" href="https://fmf-x0.github.io/feed.xml" title="FmF" /> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Pwnedcr 5 | FmF</title> <meta name="generator" content="Jekyll v4.3.2" /> <meta property="og:title" content="Pwnedcr 5" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Retos: El regalo Cryptonita Tron Enumérame Bruto el fuerte Siete a cero Scripteando El regalo: Nos dan una cadena de caracteres que se parece a una cadena encodeada en base64. Sabiendo esto, podemos intentar de decodificarlo desde una terminal de la siguiente manera: echo &quot;UFdORURDUnt2ZW5pbW9zX2VuX3Bhel9naGVpQDkwJCN9&quot; | base64 -d; echo De esta manera obtenemos la flag: PWNEDCR{venimos_en_paz_ghei@90$#} De una manera alternativa podemos ir a la siguiente pagina Link y pegamos nuestra cadena para decodificarla. Cryptonita: Vemos que esta vez no nos dan una cadena, pero si leemos de manera detenida podemos ver una pista, la cual es: “se cree que en ésta página se esta intercambiando información”, esto nos puede decir que la flag puede esta en el codigo fuente de la pagina. Vamos a ver el codigo fuente y en efecto vemos algo fuera de lo comun casi al final de la pagina, una cadena parecida a la del reto anterior pero esta vez es mucho mas larga. Vamos a tratar de decodificarlo… echo &quot;Tm9zIGVzdOFuIHNpZ3VpZW5kbyBlbCByYXN0cm8sIGhheSBxdWUgYm9ycmFyIHRvZGEgaW5mb3JtYWNp824gYW50ZXMgZGUgcXVlIHNlYSBkZW1hc2lhZG8gdGFyZGUsIGxhcyBjdWVudGFzIGVuIGxvcyBvdHJvcyBwYe1zZXMgZnVlcm9uIGJsb3F1ZWFkYXMsIGxvIPpuaWNvIHF1ZSBub3MgcXVlZGEgZXMgZWwgd2FsbGV0IGRlIGNyeXB0byBtb25lZGFzIHF1ZSBzb2xvIHVzdGVkZXMgeSB5byBzYWJlbW9zIGRvbmRlIGVzdOEsIHJlY3VlcmRlbiB1dGlsaXphciBsYSBwYWxhYnJhIGRlIHBhc28gcGFyYSBwb2RlciBzYWJlciBudWVzdHJvIHBy83hpbW8gcHVudG8gZGUgcmV1bmnzbjogW1sgVUZkT1JVUkRVbnR6WldOMGIzSmZORjloY0dGeWRHRnRaVzUwYjE4Mk5WOTZiMjVoWDI1MVkyeGxZWEpmWkdWellXeHZhbUZrWVY4MUpETXlRREY5IF1d&quot; | base64 -d; echo Vemos un mesage curioso y otra cadena que tambien se parece mucho a una cadena en base64, vamos a decodificarla: echo &quot;UFdORURDUntzZWN0b3JfNF9hcGFydGFtZW50b182NV96b25hX251Y2xlYXJfZGVzYWxvamFkYV81JDMyQDF9&quot; | base64 -d; echo Con esto ya podemos ver la flag: PWNEDCR{sector_4_apartamento_65_zona_nuclear_desalojada_5$32@1} Tron: Vemos que nos dan una pista la cual es: “la imagen contiene algún mensaje” y con esto ya nos viene a la mente que puede ser un mensaje fue escondido con esteganografía. Para analizar la image a un nivel mas bajo podemos utilizar la herramienta: exiftool la cual es una herramienta para ver los metadatos en archivos. Podemos descargar la imagen y ejecutar el siguiente comando para analizarla. exiftool tron.png Y en efecto vemos bastante informacion y entre ella la flag: Enumérame: Nos dan esta pista “reto4.php?id=123” ya podemos pensar en un ataque IDOR (Insecure direct object references) lo que podemos hacer es ir iterando entre numeros, 124, 125, 126…etc. Poniendo 126 en lugar de 123: “https://ctf.pwnedcr.com/retos/reto4.php?id=126” ya podemos ver la flag: Bruto el fuerte Podemos descargar los dos diccionarios que nos proveen ya que los vamos a utilizar. Presionando “Abrir app” y nos abre la siguiente ventana: Nos dan una pista con el titulo ya que se refiere a un “ataque de fuerza bruta”. Con la herramienta hydra podemos hacer el ataque… hydra -L top-usernames-shortlist.txt -P rockyou_top-1k.txt ctf.pwnedcr.com https-post-form &quot;/retos/reto5_login.php:username=^USER^&amp;password=^PASS^:F=ACCESS DENIED&quot; Uso de hydra: -L –&gt; Indicamos que le vamos a pasar un diccionario de usuarios. -P –&gt; Indicamos que le vamos a pasar un diccionario de contraseñas. ctf.pwnedcr.com –&gt; Es el dominio que vamos a atacar. https-post-form –&gt; Vamos a enviar un formulario que serian el usuario y contraseña. /retos/reto5_login.php –&gt; La ruta donde se ubica el formulario que vamos a atacar. :username=^USER^&amp;password=^PASS^ –&gt; Estos son los campos que vamos a atacar con hydra el username y password, para saber si son diferentes nos podemos fijar en la peticion que estamos enviando por burp o tambien lo podemos ver en el codigo fuente. :F=ACCESS DENIED –&gt; El “ACCESS DENIED” es la palabra que la pagina web nos va a dar si hacemos un intento fallido, el “ACCESS DENIED” lo saque del codigo fuente de la pagina cuando ponemos unas credenciales no validas, lo vemos en la siguiente imagen: Para mas informacion recomiendo buscar en google ;) Ejecutamos comando anterior en nuestra terminal y obtenemos un username y un password: admin:jordan23 Y obtenemos la flag. Siete a cero: Presionando “Abrir app” y nos abre la siguiente ventana: Ponemos “test” y “test” y vemos que el output se ve reflejado y pensamos en un ataque xss. (Al principio intente hacer un bypass del login y dure muchas horas y no pude hacer nada y al hacer un xss fue algo irreal.) Para hacer el ataque xss ponemos: “&lt;script&gt;alert(1)&lt;/script&gt;” en la parte del usuario y en la parte del password ponemos lo que querramos. (“Tiene que ser exactamente igual por que si variamos auque sea el numero, no nos dara la flag”) y con esto conseguimos la flag: Scripteando: No hay muchas pistas pero empezamos con un analizis del codigo fuente de la pagina y vemos algo interesante: Viendo mas esa linea de codigo podemos notar que ahi esta la flag:" /> <meta property="og:description" content="Retos: El regalo Cryptonita Tron Enumérame Bruto el fuerte Siete a cero Scripteando El regalo: Nos dan una cadena de caracteres que se parece a una cadena encodeada en base64. Sabiendo esto, podemos intentar de decodificarlo desde una terminal de la siguiente manera: echo &quot;UFdORURDUnt2ZW5pbW9zX2VuX3Bhel9naGVpQDkwJCN9&quot; | base64 -d; echo De esta manera obtenemos la flag: PWNEDCR{venimos_en_paz_ghei@90$#} De una manera alternativa podemos ir a la siguiente pagina Link y pegamos nuestra cadena para decodificarla. Cryptonita: Vemos que esta vez no nos dan una cadena, pero si leemos de manera detenida podemos ver una pista, la cual es: “se cree que en ésta página se esta intercambiando información”, esto nos puede decir que la flag puede esta en el codigo fuente de la pagina. Vamos a ver el codigo fuente y en efecto vemos algo fuera de lo comun casi al final de la pagina, una cadena parecida a la del reto anterior pero esta vez es mucho mas larga. Vamos a tratar de decodificarlo… echo &quot;Tm9zIGVzdOFuIHNpZ3VpZW5kbyBlbCByYXN0cm8sIGhheSBxdWUgYm9ycmFyIHRvZGEgaW5mb3JtYWNp824gYW50ZXMgZGUgcXVlIHNlYSBkZW1hc2lhZG8gdGFyZGUsIGxhcyBjdWVudGFzIGVuIGxvcyBvdHJvcyBwYe1zZXMgZnVlcm9uIGJsb3F1ZWFkYXMsIGxvIPpuaWNvIHF1ZSBub3MgcXVlZGEgZXMgZWwgd2FsbGV0IGRlIGNyeXB0byBtb25lZGFzIHF1ZSBzb2xvIHVzdGVkZXMgeSB5byBzYWJlbW9zIGRvbmRlIGVzdOEsIHJlY3VlcmRlbiB1dGlsaXphciBsYSBwYWxhYnJhIGRlIHBhc28gcGFyYSBwb2RlciBzYWJlciBudWVzdHJvIHBy83hpbW8gcHVudG8gZGUgcmV1bmnzbjogW1sgVUZkT1JVUkRVbnR6WldOMGIzSmZORjloY0dGeWRHRnRaVzUwYjE4Mk5WOTZiMjVoWDI1MVkyeGxZWEpmWkdWellXeHZhbUZrWVY4MUpETXlRREY5IF1d&quot; | base64 -d; echo Vemos un mesage curioso y otra cadena que tambien se parece mucho a una cadena en base64, vamos a decodificarla: echo &quot;UFdORURDUntzZWN0b3JfNF9hcGFydGFtZW50b182NV96b25hX251Y2xlYXJfZGVzYWxvamFkYV81JDMyQDF9&quot; | base64 -d; echo Con esto ya podemos ver la flag: PWNEDCR{sector_4_apartamento_65_zona_nuclear_desalojada_5$32@1} Tron: Vemos que nos dan una pista la cual es: “la imagen contiene algún mensaje” y con esto ya nos viene a la mente que puede ser un mensaje fue escondido con esteganografía. Para analizar la image a un nivel mas bajo podemos utilizar la herramienta: exiftool la cual es una herramienta para ver los metadatos en archivos. Podemos descargar la imagen y ejecutar el siguiente comando para analizarla. exiftool tron.png Y en efecto vemos bastante informacion y entre ella la flag: Enumérame: Nos dan esta pista “reto4.php?id=123” ya podemos pensar en un ataque IDOR (Insecure direct object references) lo que podemos hacer es ir iterando entre numeros, 124, 125, 126…etc. Poniendo 126 en lugar de 123: “https://ctf.pwnedcr.com/retos/reto4.php?id=126” ya podemos ver la flag: Bruto el fuerte Podemos descargar los dos diccionarios que nos proveen ya que los vamos a utilizar. Presionando “Abrir app” y nos abre la siguiente ventana: Nos dan una pista con el titulo ya que se refiere a un “ataque de fuerza bruta”. Con la herramienta hydra podemos hacer el ataque… hydra -L top-usernames-shortlist.txt -P rockyou_top-1k.txt ctf.pwnedcr.com https-post-form &quot;/retos/reto5_login.php:username=^USER^&amp;password=^PASS^:F=ACCESS DENIED&quot; Uso de hydra: -L –&gt; Indicamos que le vamos a pasar un diccionario de usuarios. -P –&gt; Indicamos que le vamos a pasar un diccionario de contraseñas. ctf.pwnedcr.com –&gt; Es el dominio que vamos a atacar. https-post-form –&gt; Vamos a enviar un formulario que serian el usuario y contraseña. /retos/reto5_login.php –&gt; La ruta donde se ubica el formulario que vamos a atacar. :username=^USER^&amp;password=^PASS^ –&gt; Estos son los campos que vamos a atacar con hydra el username y password, para saber si son diferentes nos podemos fijar en la peticion que estamos enviando por burp o tambien lo podemos ver en el codigo fuente. :F=ACCESS DENIED –&gt; El “ACCESS DENIED” es la palabra que la pagina web nos va a dar si hacemos un intento fallido, el “ACCESS DENIED” lo saque del codigo fuente de la pagina cuando ponemos unas credenciales no validas, lo vemos en la siguiente imagen: Para mas informacion recomiendo buscar en google ;) Ejecutamos comando anterior en nuestra terminal y obtenemos un username y un password: admin:jordan23 Y obtenemos la flag. Siete a cero: Presionando “Abrir app” y nos abre la siguiente ventana: Ponemos “test” y “test” y vemos que el output se ve reflejado y pensamos en un ataque xss. (Al principio intente hacer un bypass del login y dure muchas horas y no pude hacer nada y al hacer un xss fue algo irreal.) Para hacer el ataque xss ponemos: “&lt;script&gt;alert(1)&lt;/script&gt;” en la parte del usuario y en la parte del password ponemos lo que querramos. (“Tiene que ser exactamente igual por que si variamos auque sea el numero, no nos dara la flag”) y con esto conseguimos la flag: Scripteando: No hay muchas pistas pero empezamos con un analizis del codigo fuente de la pagina y vemos algo interesante: Viendo mas esa linea de codigo podemos notar que ahi esta la flag:" /> <link rel="canonical" href="https://fmf-x0.github.io/pwnedcr/Pwnedcr-5" /> <meta property="og:url" content="https://fmf-x0.github.io/pwnedcr/Pwnedcr-5" /> <meta property="og:site_name" content="FmF" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2022-12-08T00:00:00-06:00" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Pwnedcr 5" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-12-08T00:00:00-06:00","datePublished":"2022-12-08T00:00:00-06:00","description":"Retos: El regalo Cryptonita Tron Enumérame Bruto el fuerte Siete a cero Scripteando El regalo: Nos dan una cadena de caracteres que se parece a una cadena encodeada en base64. Sabiendo esto, podemos intentar de decodificarlo desde una terminal de la siguiente manera: echo &quot;UFdORURDUnt2ZW5pbW9zX2VuX3Bhel9naGVpQDkwJCN9&quot; | base64 -d; echo De esta manera obtenemos la flag: PWNEDCR{venimos_en_paz_ghei@90$#} De una manera alternativa podemos ir a la siguiente pagina Link y pegamos nuestra cadena para decodificarla. Cryptonita: Vemos que esta vez no nos dan una cadena, pero si leemos de manera detenida podemos ver una pista, la cual es: “se cree que en ésta página se esta intercambiando información”, esto nos puede decir que la flag puede esta en el codigo fuente de la pagina. Vamos a ver el codigo fuente y en efecto vemos algo fuera de lo comun casi al final de la pagina, una cadena parecida a la del reto anterior pero esta vez es mucho mas larga. Vamos a tratar de decodificarlo… echo &quot;Tm9zIGVzdOFuIHNpZ3VpZW5kbyBlbCByYXN0cm8sIGhheSBxdWUgYm9ycmFyIHRvZGEgaW5mb3JtYWNp824gYW50ZXMgZGUgcXVlIHNlYSBkZW1hc2lhZG8gdGFyZGUsIGxhcyBjdWVudGFzIGVuIGxvcyBvdHJvcyBwYe1zZXMgZnVlcm9uIGJsb3F1ZWFkYXMsIGxvIPpuaWNvIHF1ZSBub3MgcXVlZGEgZXMgZWwgd2FsbGV0IGRlIGNyeXB0byBtb25lZGFzIHF1ZSBzb2xvIHVzdGVkZXMgeSB5byBzYWJlbW9zIGRvbmRlIGVzdOEsIHJlY3VlcmRlbiB1dGlsaXphciBsYSBwYWxhYnJhIGRlIHBhc28gcGFyYSBwb2RlciBzYWJlciBudWVzdHJvIHBy83hpbW8gcHVudG8gZGUgcmV1bmnzbjogW1sgVUZkT1JVUkRVbnR6WldOMGIzSmZORjloY0dGeWRHRnRaVzUwYjE4Mk5WOTZiMjVoWDI1MVkyeGxZWEpmWkdWellXeHZhbUZrWVY4MUpETXlRREY5IF1d&quot; | base64 -d; echo Vemos un mesage curioso y otra cadena que tambien se parece mucho a una cadena en base64, vamos a decodificarla: echo &quot;UFdORURDUntzZWN0b3JfNF9hcGFydGFtZW50b182NV96b25hX251Y2xlYXJfZGVzYWxvamFkYV81JDMyQDF9&quot; | base64 -d; echo Con esto ya podemos ver la flag: PWNEDCR{sector_4_apartamento_65_zona_nuclear_desalojada_5$32@1} Tron: Vemos que nos dan una pista la cual es: “la imagen contiene algún mensaje” y con esto ya nos viene a la mente que puede ser un mensaje fue escondido con esteganografía. Para analizar la image a un nivel mas bajo podemos utilizar la herramienta: exiftool la cual es una herramienta para ver los metadatos en archivos. Podemos descargar la imagen y ejecutar el siguiente comando para analizarla. exiftool tron.png Y en efecto vemos bastante informacion y entre ella la flag: Enumérame: Nos dan esta pista “reto4.php?id=123” ya podemos pensar en un ataque IDOR (Insecure direct object references) lo que podemos hacer es ir iterando entre numeros, 124, 125, 126…etc. Poniendo 126 en lugar de 123: “https://ctf.pwnedcr.com/retos/reto4.php?id=126” ya podemos ver la flag: Bruto el fuerte Podemos descargar los dos diccionarios que nos proveen ya que los vamos a utilizar. Presionando “Abrir app” y nos abre la siguiente ventana: Nos dan una pista con el titulo ya que se refiere a un “ataque de fuerza bruta”. Con la herramienta hydra podemos hacer el ataque… hydra -L top-usernames-shortlist.txt -P rockyou_top-1k.txt ctf.pwnedcr.com https-post-form &quot;/retos/reto5_login.php:username=^USER^&amp;password=^PASS^:F=ACCESS DENIED&quot; Uso de hydra: -L –&gt; Indicamos que le vamos a pasar un diccionario de usuarios. -P –&gt; Indicamos que le vamos a pasar un diccionario de contraseñas. ctf.pwnedcr.com –&gt; Es el dominio que vamos a atacar. https-post-form –&gt; Vamos a enviar un formulario que serian el usuario y contraseña. /retos/reto5_login.php –&gt; La ruta donde se ubica el formulario que vamos a atacar. :username=^USER^&amp;password=^PASS^ –&gt; Estos son los campos que vamos a atacar con hydra el username y password, para saber si son diferentes nos podemos fijar en la peticion que estamos enviando por burp o tambien lo podemos ver en el codigo fuente. :F=ACCESS DENIED –&gt; El “ACCESS DENIED” es la palabra que la pagina web nos va a dar si hacemos un intento fallido, el “ACCESS DENIED” lo saque del codigo fuente de la pagina cuando ponemos unas credenciales no validas, lo vemos en la siguiente imagen: Para mas informacion recomiendo buscar en google ;) Ejecutamos comando anterior en nuestra terminal y obtenemos un username y un password: admin:jordan23 Y obtenemos la flag. Siete a cero: Presionando “Abrir app” y nos abre la siguiente ventana: Ponemos “test” y “test” y vemos que el output se ve reflejado y pensamos en un ataque xss. (Al principio intente hacer un bypass del login y dure muchas horas y no pude hacer nada y al hacer un xss fue algo irreal.) Para hacer el ataque xss ponemos: “&lt;script&gt;alert(1)&lt;/script&gt;” en la parte del usuario y en la parte del password ponemos lo que querramos. (“Tiene que ser exactamente igual por que si variamos auque sea el numero, no nos dara la flag”) y con esto conseguimos la flag: Scripteando: No hay muchas pistas pero empezamos con un analizis del codigo fuente de la pagina y vemos algo interesante: Viendo mas esa linea de codigo podemos notar que ahi esta la flag:","headline":"Pwnedcr 5","mainEntityOfPage":{"@type":"WebPage","@id":"https://fmf-x0.github.io/pwnedcr/Pwnedcr-5"},"url":"https://fmf-x0.github.io/pwnedcr/Pwnedcr-5"}</script> <!-- End Jekyll SEO tag --> <link rel="shortcut icon" href="/favicon.ico" type="image/icon"> <link rel="icon" href="/favicon.ico" type="image/icon"> <!-- stylesheets --> <link rel="stylesheet" type="text/css" href="/assets/css/base.css"> <link rel="stylesheet" type="text/css" href="/assets/css/simplePagination.css"> <link rel="stylesheet" type="text/css" href="/assets/css/highlight-theme.css"> <link rel="stylesheet" type="text/css" href="/assets/css/rouge-code.css"> <link rel="stylesheet" type="text/css" href="/assets/css/post.css"> <!-- javascripts --> <script type="text/javascript" src="/assets/js/jquery.js"></script> <!--[if lt IE 9]> <script src="/assets/js/html5shiv.js"></script> <![endif]--> </head> <!-- bare layout means not header and footer like resume --> <body> <header id="l-header"> <div class="container"> <div class="row navicon"> <a href=""><i class="fa fa-navicon"></i></a> </div> <div class="row navbar"> <nav class="col-lg-8 col-md-8 col-xs-12"> <ul class="row"> <li class="col-lg-3"><a href="/">HOME</a></li> <li class="col-lg-3"> <ul class="subnav"> <a href="javascript:void(0)">POST</a> <li><a href="/category">CATEGORY</a></li> <li><a href="/tag">TAG</a></li> </ul> </li> <li class="col-lg-3"><a href="/about">ABOUT</a></li> </ul> </nav> <div class="search col-lg-4 col-md-4 col-xs-12"> <form> <label for="search"></label> <input id="search-input" name="serach" type="text" placeholder="Search Blog Posts..."> <i class="fa fa-search"></i> </form> </div> </div> </div> </header> <section id="l-main"> <div class="container"> <div id="search-result-wrapper" class="hidden"> <h3>Search Results:</h3> <div id="search-result"></div> </div> <style> #search-result-wrapper { font-size: 2rem; background-color: #eee; padding: 5rem; padding-left: 31rem; margin-top: 1rem; margin-bottom: 1rem; box-shadow: 0 0 10px #999; border-radius: 5px; background: white; } #search-result { padding-left: 3rem; } @media (max-width: 1200px) { #search-result-wrapper { font-size: 1.7rem; padding: 2rem; } #search-result { padding-left: 1rem; } } @media (max-width: 768px) { #search-result-wrapper { margin-top: 24rem !important; } } </style> <script> $(document).ready(function() { input = $("#search-input"); wrapper = $("#search-result-wrapper"); wrapper.hide(); wrapper.removeClass("hidden"); input.on("keyup change", function() { if (! input.val()) { wrapper.slideUp("ease"); } else { wrapper.slideDown("ease"); } }); }); </script> <script src="/assets/js/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-result'), json: "/search.json" }); </script> <div class="row"> <div id="markdown-container" class="col-lg-12"> <header> <p id="post-title">Pwnedcr 5</p> <ul class="tags clearfix"> <li><i class="fa fa-tag"></i> Pwnedcr5</li> <li><i class="fa fa-tag"></i> Easy</li> </ul> </header> <p><img src="/assets/img/pwnedcr5/pwnedcr-5.png" width="800" /></p> <h3 id="retos">Retos:</h3> <ul> <li>El regalo</li> <li>Cryptonita</li> <li>Tron</li> <li>Enumérame</li> <li>Bruto el fuerte</li> <li>Siete a cero</li> <li>Scripteando</li> </ul> <h1 id="el-regalo">El regalo:</h1> <p><img src="/assets/img/pwnedcr5/1.png" width="600" /></p> <p>Nos dan una cadena de caracteres que se parece a una cadena encodeada en base64.</p> <p>Sabiendo esto, podemos intentar de decodificarlo desde una terminal de la siguiente manera:</p> <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">echo</span> <span class="s2">"UFdORURDUnt2ZW5pbW9zX2VuX3Bhel9naGVpQDkwJCN9"</span> <span class="o">|</span> <span class="n">base64</span> <span class="o">-</span><span class="n">d</span><span class="p">;</span> <span class="n">echo</span>
</code></pre></div></div> <p>De esta manera obtenemos la flag: <strong>PWNEDCR{venimos_en_paz_ghei@90$#}</strong></p> <p>De una manera alternativa podemos ir a la siguiente pagina <a href="https://www.base64decode.org/" title="Base64 decoder">Link</a> y pegamos nuestra cadena para decodificarla.</p> <h1 id="cryptonita">Cryptonita:</h1> <p><img src="/assets/img/pwnedcr5/2.png" width="600" /></p> <p>Vemos que esta vez no nos dan una cadena, pero si leemos de manera detenida podemos ver una pista, la cual es: “se cree que en ésta página se esta intercambiando información”, esto nos puede decir que la flag puede esta en el codigo fuente de la pagina.</p> <p>Vamos a ver el codigo fuente y en efecto vemos algo fuera de lo comun casi al final de la pagina, una cadena parecida a la del reto anterior pero esta vez es mucho mas larga.</p> <p><img src="/assets/img/pwnedcr5/3.png" width="600" /></p> <p>Vamos a tratar de decodificarlo…</p> <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">echo</span> <span class="s2">"Tm9zIGVzdOFuIHNpZ3VpZW5kbyBlbCByYXN0cm8sIGhheSBxdWUgYm9ycmFyIHRvZGEgaW5mb3JtYWNp824gYW50ZXMgZGUgcXVlIHNlYSBkZW1hc2lhZG8gdGFyZGUsIGxhcyBjdWVudGFzIGVuIGxvcyBvdHJvcyBwYe1zZXMgZnVlcm9uIGJsb3F1ZWFkYXMsIGxvIPpuaWNvIHF1ZSBub3MgcXVlZGEgZXMgZWwgd2FsbGV0IGRlIGNyeXB0byBtb25lZGFzIHF1ZSBzb2xvIHVzdGVkZXMgeSB5byBzYWJlbW9zIGRvbmRlIGVzdOEsIHJlY3VlcmRlbiB1dGlsaXphciBsYSBwYWxhYnJhIGRlIHBhc28gcGFyYSBwb2RlciBzYWJlciBudWVzdHJvIHBy83hpbW8gcHVudG8gZGUgcmV1bmnzbjogW1sgVUZkT1JVUkRVbnR6WldOMGIzSmZORjloY0dGeWRHRnRaVzUwYjE4Mk5WOTZiMjVoWDI1MVkyeGxZWEpmWkdWellXeHZhbUZrWVY4MUpETXlRREY5IF1d"</span> <span class="o">|</span> <span class="n">base64</span> <span class="o">-</span><span class="n">d</span><span class="p">;</span> <span class="n">echo</span>
</code></pre></div></div> <p><img src="/assets/img/pwnedcr5/4.png" width="600" /></p> <p>Vemos un mesage curioso y otra cadena que tambien se parece mucho a una cadena en base64, vamos a decodificarla:</p> <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">echo</span> <span class="s2">"UFdORURDUntzZWN0b3JfNF9hcGFydGFtZW50b182NV96b25hX251Y2xlYXJfZGVzYWxvamFkYV81JDMyQDF9"</span> <span class="o">|</span> <span class="n">base64</span> <span class="o">-</span><span class="n">d</span><span class="p">;</span> <span class="n">echo</span>
</code></pre></div></div> <p>Con esto ya podemos ver la flag: <strong>PWNEDCR{sector_4_apartamento_65_zona_nuclear_desalojada_5$32@1}</strong></p> <h1 id="tron">Tron:</h1> <p><img src="/assets/img/pwnedcr5/5.png" width="600" /></p> <p>Vemos que nos dan una pista la cual es: “la imagen contiene algún mensaje” y con esto ya nos viene a la mente que puede ser un mensaje fue escondido con esteganografía.</p> <p>Para analizar la image a un nivel mas bajo podemos utilizar la herramienta: <em>exiftool</em> la cual es una herramienta para ver los metadatos en archivos.</p> <p>Podemos descargar la imagen y ejecutar el siguiente comando para analizarla.</p> <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">exiftool</span> <span class="n">tron</span><span class="p">.</span><span class="nf">png</span>
</code></pre></div></div> <p>Y en efecto vemos bastante informacion y entre ella la flag:</p> <p><img src="/assets/img/pwnedcr5/6.png" width="600" /></p> <h1 id="enumérame">Enumérame:</h1> <p><img src="/assets/img/pwnedcr5/7.png" width="600" /></p> <p>Nos dan esta pista “reto4.php?id=123” ya podemos pensar en un ataque IDOR (Insecure direct object references) lo que podemos hacer es ir iterando entre numeros, 124, 125, 126…etc.</p> <p>Poniendo 126 en lugar de 123: “<code class="language-plaintext highlighter-rouge">https://ctf.pwnedcr.com/retos/reto4.php?id=126</code>” ya podemos ver la flag:</p> <p><img src="/assets/img/pwnedcr5/8.png" width="600" /></p> <h1 id="bruto-el-fuerte">Bruto el fuerte</h1> <p><img src="/assets/img/pwnedcr5/9.png" width="600" /></p> <p>Podemos descargar los dos diccionarios que nos proveen ya que los vamos a utilizar.</p> <p>Presionando “Abrir app” y nos abre la siguiente ventana:</p> <p><img src="/assets/img/pwnedcr5/10.png" width="600" /></p> <p>Nos dan una pista con el titulo ya que se refiere a un “ataque de fuerza bruta”.</p> <p>Con la herramienta <em>hydra</em> podemos hacer el ataque…</p> <div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">hydra</span> <span class="o">-</span><span class="no">L</span> <span class="n">top</span><span class="o">-</span><span class="n">usernames</span><span class="o">-</span><span class="n">shortlist</span><span class="p">.</span><span class="nf">txt</span> <span class="o">-</span><span class="no">P</span> <span class="n">rockyou_top</span><span class="o">-</span><span class="mi">1</span><span class="n">k</span><span class="p">.</span><span class="nf">txt</span> <span class="n">ctf</span><span class="p">.</span><span class="nf">pwnedcr</span><span class="p">.</span><span class="nf">com</span> <span class="n">https</span><span class="o">-</span><span class="n">post</span><span class="o">-</span><span class="n">form</span> <span class="s2">"/retos/reto5_login.php:username=^USER^&amp;password=^PASS^:F=ACCESS DENIED"</span>
</code></pre></div></div> <p>Uso de <em>hydra</em>:</p> <ul> <li>-L –&gt; Indicamos que le vamos a pasar un diccionario de <strong>usuarios</strong>.</li> <li>-P –&gt; Indicamos que le vamos a pasar un diccionario de <strong>contraseñas</strong>.</li> <li>ctf.pwnedcr.com –&gt; Es el dominio que vamos a atacar.</li> <li>https-post-form –&gt; Vamos a enviar un formulario que serian el usuario y contraseña.</li> <li>/retos/reto5_login.php –&gt; La ruta donde se ubica el formulario que vamos a atacar.</li> <li>:username=^USER^&amp;password=^PASS^ –&gt; Estos son los campos que vamos a atacar con hydra el username y password, para saber si son diferentes nos podemos fijar en la peticion que estamos enviando por burp o tambien lo podemos ver en el codigo fuente.</li> <li>:F=ACCESS DENIED –&gt; El “ACCESS DENIED” es la palabra que la pagina web nos va a dar si hacemos un intento fallido, el “ACCESS DENIED” lo saque del codigo fuente de la pagina cuando ponemos unas credenciales no validas, lo vemos en la siguiente imagen:</li> </ul> <p><img src="/assets/img/pwnedcr5/18.png" width="600" /></p> <p>Para mas informacion recomiendo buscar en google ;)</p> <p>Ejecutamos comando anterior en nuestra terminal y obtenemos un username y un password: admin:jordan23</p> <p>Y obtenemos la flag.</p> <p><img src="/assets/img/pwnedcr5/17.png" width="600" /></p> <h1 id="siete-a-cero">Siete a cero:</h1> <p><img src="/assets/img/pwnedcr5/11.png" width="600" /></p> <p>Presionando “Abrir app” y nos abre la siguiente ventana:</p> <p><img src="/assets/img/pwnedcr5/10.png" width="600" /></p> <p>Ponemos “test” y “test” y vemos que el output se ve reflejado y pensamos en un ataque xss. (Al principio intente hacer un bypass del login y dure muchas horas y no pude hacer nada y al hacer un xss fue algo irreal.)</p> <p><img src="/assets/img/pwnedcr5/12.png" width="600" /></p> <p>Para hacer el ataque xss ponemos: “<strong>&lt;script&gt;alert(1)&lt;/script&gt;</strong>” en la parte del usuario y en la parte del password ponemos lo que querramos. (“Tiene que ser exactamente igual por que si variamos auque sea el numero, no nos dara la flag”)</p> <p>y con esto conseguimos la flag:</p> <p><img src="/assets/img/pwnedcr5/13.png" width="600" /></p> <h1 id="scripteando">Scripteando:</h1> <p><img src="/assets/img/pwnedcr5/14.png" width="600" /></p> <p>No hay muchas pistas pero empezamos con un analizis del codigo fuente de la pagina y vemos algo interesante:</p> <p><img src="/assets/img/pwnedcr5/15.png" width="800" /></p> <p>Viendo mas esa linea de codigo podemos notar que ahi esta la flag:</p> <p><img src="/assets/img/pwnedcr5/16.png" width="800" /></p> </div> </div> </div> </section> <style> footer { text-align: center; padding: 20px; /* Optional: Add padding for spacing */ color: #fff; /* Optional: Set text color */ } </style> <footer> <h3>Made with ❤️ by <span style="color: #cf0;">FmF</span></h3> </footer> </body> </html>
