<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <meta name="description" content="🦜 Parrot CTFs is an advanced cybersecurity education platform and Capture The Flag provider. Their goal is to create the most realistic Capture The Flag chal..."> <link type="application/atom+xml" rel="alternate" href="https://fmf-x0.github.io/feed.xml" title="FmF" /> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Santa’s List | FmF</title> <meta name="generator" content="Jekyll v4.3.2" /> <meta property="og:title" content="Santa’s List" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="🦜 Parrot CTFs is an advanced cybersecurity education platform and Capture The Flag provider. Their goal is to create the most realistic Capture The Flag challenges and demonstrate real-world attack scenarios. Content: Enumeration Initial access Privilege escalation Enumeration 🔎: We start by using ping to check the TTL of the machine to determine the OS we are dealing with. Based on the TTL value of 63, we can determine that the machine is running a Linux machine. However, this is not for sure, but it gives us an idea. For more information, you can view: Identify OS using TTL value. Now, let’s go with an nmap scan to view the open ports. sudo nmap -p- --open -sS --min-rate 5000 -n -v -Pn 10.14.0.9 -oN allPorts -p- –&gt; We are doing a scan against all 65535 ports to search for open ports. --open –&gt; It will only report open ports. -sS –&gt; It can be performed quickly, scanning thousands of ports per second. --min-rate 5000 –&gt; It sets the minimum rate of packets sent per second to 5000. -n –&gt; Tells Nmap to never do reverse DNS resolution on the active IP addresses it finds. -v –&gt; It will be verbose in its output. -Pn –&gt; This option skips the host discovery stage. -oN –&gt; It will save the output in a file called “allPorts”. We find out the following open ports: Let’s take a look at what the page has. We can see a login panel that has some information that we can use. The login panel says Santa&#39;s administration panel, so maybe a valid username can be santa. Initial access 🔑: We can try common credentials like admin:admin or root:root and many others… But let’s try with the information that we have santa:santa, santa:admin or santa:northpole and with those credentials, we can gain access… But let’s try other ways rather than guessing. For example, we can use the tool cewl to create a wordlist based on the content of the page. cewl http://10.14.0.9/ --lowercase -w wordlist.txt We can use the tool cupp to generate different variations of words. ./cupp -w wordlist.txt –&gt; We pass the wordlist that we created with cewl. The content of the wordlist.txt.cupp.txt file generated by cupp is as follows: We can see that it generates a lot of variations. Now let’s do a bruteforce attack with the use of wordlist that we have and let’s try with the username santa. There are many ways to complete a bruteforce attack. We will use the tool hydra in this case. hydra -l santa -P wordlist.txt.cupp.txt 10.14.0.9 http-post-form &quot;/index.php:username=santa&amp;password=^PASS^:Incorrect login&quot; -v And the correct credentials are santa:northpole. We are in and we can see a button to download a file. We can see a new username: elf-manager. Maybe we can use it to login with SSH. But let’s first decrypt the MD5 hashes with md5decrypt.net. What if we try reusing the password northpole with the username elf-manager? We can try to connect to SSH and see if we can get in. It works 🎉. Now that we are inside the machine you need to do some things to ensure smooth operation: export TERM=xterm This will allow us to clean the screen with ctrl + l. Now we can see the flag 🎉. Privilege escalation 🚩: We need to enumerate the system to find a way to escalate privileges. One thing I always check first is sudo -l. This command helps us determine if we have the ability to execute commands as other user. If we are lucky, we might discover that we can execute commands with the privileges of the root user. More info about privilege escalation techniques check here. We can execute vim command as the root user. We can see in GTFOBins for a way to escalate privileges. Or we can do it this way: sudo vim esc + : + !bash --&gt; This is to spawn a shell as root user. And now we are root :) Hope you like it and learn something new :)" /> <meta property="og:description" content="🦜 Parrot CTFs is an advanced cybersecurity education platform and Capture The Flag provider. Their goal is to create the most realistic Capture The Flag challenges and demonstrate real-world attack scenarios. Content: Enumeration Initial access Privilege escalation Enumeration 🔎: We start by using ping to check the TTL of the machine to determine the OS we are dealing with. Based on the TTL value of 63, we can determine that the machine is running a Linux machine. However, this is not for sure, but it gives us an idea. For more information, you can view: Identify OS using TTL value. Now, let’s go with an nmap scan to view the open ports. sudo nmap -p- --open -sS --min-rate 5000 -n -v -Pn 10.14.0.9 -oN allPorts -p- –&gt; We are doing a scan against all 65535 ports to search for open ports. --open –&gt; It will only report open ports. -sS –&gt; It can be performed quickly, scanning thousands of ports per second. --min-rate 5000 –&gt; It sets the minimum rate of packets sent per second to 5000. -n –&gt; Tells Nmap to never do reverse DNS resolution on the active IP addresses it finds. -v –&gt; It will be verbose in its output. -Pn –&gt; This option skips the host discovery stage. -oN –&gt; It will save the output in a file called “allPorts”. We find out the following open ports: Let’s take a look at what the page has. We can see a login panel that has some information that we can use. The login panel says Santa&#39;s administration panel, so maybe a valid username can be santa. Initial access 🔑: We can try common credentials like admin:admin or root:root and many others… But let’s try with the information that we have santa:santa, santa:admin or santa:northpole and with those credentials, we can gain access… But let’s try other ways rather than guessing. For example, we can use the tool cewl to create a wordlist based on the content of the page. cewl http://10.14.0.9/ --lowercase -w wordlist.txt We can use the tool cupp to generate different variations of words. ./cupp -w wordlist.txt –&gt; We pass the wordlist that we created with cewl. The content of the wordlist.txt.cupp.txt file generated by cupp is as follows: We can see that it generates a lot of variations. Now let’s do a bruteforce attack with the use of wordlist that we have and let’s try with the username santa. There are many ways to complete a bruteforce attack. We will use the tool hydra in this case. hydra -l santa -P wordlist.txt.cupp.txt 10.14.0.9 http-post-form &quot;/index.php:username=santa&amp;password=^PASS^:Incorrect login&quot; -v And the correct credentials are santa:northpole. We are in and we can see a button to download a file. We can see a new username: elf-manager. Maybe we can use it to login with SSH. But let’s first decrypt the MD5 hashes with md5decrypt.net. What if we try reusing the password northpole with the username elf-manager? We can try to connect to SSH and see if we can get in. It works 🎉. Now that we are inside the machine you need to do some things to ensure smooth operation: export TERM=xterm This will allow us to clean the screen with ctrl + l. Now we can see the flag 🎉. Privilege escalation 🚩: We need to enumerate the system to find a way to escalate privileges. One thing I always check first is sudo -l. This command helps us determine if we have the ability to execute commands as other user. If we are lucky, we might discover that we can execute commands with the privileges of the root user. More info about privilege escalation techniques check here. We can execute vim command as the root user. We can see in GTFOBins for a way to escalate privileges. Or we can do it this way: sudo vim esc + : + !bash --&gt; This is to spawn a shell as root user. And now we are root :) Hope you like it and learn something new :)" /> <link rel="canonical" href="https://fmf-x0.github.io/parrot-ctf/Santa's-list" /> <meta property="og:url" content="https://fmf-x0.github.io/parrot-ctf/Santa's-list" /> <meta property="og:site_name" content="FmF" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2023-08-30T00:00:00-05:00" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Santa’s List" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-08-30T00:00:00-05:00","datePublished":"2023-08-30T00:00:00-05:00","description":"🦜 Parrot CTFs is an advanced cybersecurity education platform and Capture The Flag provider. Their goal is to create the most realistic Capture The Flag challenges and demonstrate real-world attack scenarios. Content: Enumeration Initial access Privilege escalation Enumeration 🔎: We start by using ping to check the TTL of the machine to determine the OS we are dealing with. Based on the TTL value of 63, we can determine that the machine is running a Linux machine. However, this is not for sure, but it gives us an idea. For more information, you can view: Identify OS using TTL value. Now, let’s go with an nmap scan to view the open ports. sudo nmap -p- --open -sS --min-rate 5000 -n -v -Pn 10.14.0.9 -oN allPorts -p- –&gt; We are doing a scan against all 65535 ports to search for open ports. --open –&gt; It will only report open ports. -sS –&gt; It can be performed quickly, scanning thousands of ports per second. --min-rate 5000 –&gt; It sets the minimum rate of packets sent per second to 5000. -n –&gt; Tells Nmap to never do reverse DNS resolution on the active IP addresses it finds. -v –&gt; It will be verbose in its output. -Pn –&gt; This option skips the host discovery stage. -oN –&gt; It will save the output in a file called “allPorts”. We find out the following open ports: Let’s take a look at what the page has. We can see a login panel that has some information that we can use. The login panel says Santa&#39;s administration panel, so maybe a valid username can be santa. Initial access 🔑: We can try common credentials like admin:admin or root:root and many others… But let’s try with the information that we have santa:santa, santa:admin or santa:northpole and with those credentials, we can gain access… But let’s try other ways rather than guessing. For example, we can use the tool cewl to create a wordlist based on the content of the page. cewl http://10.14.0.9/ --lowercase -w wordlist.txt We can use the tool cupp to generate different variations of words. ./cupp -w wordlist.txt –&gt; We pass the wordlist that we created with cewl. The content of the wordlist.txt.cupp.txt file generated by cupp is as follows: We can see that it generates a lot of variations. Now let’s do a bruteforce attack with the use of wordlist that we have and let’s try with the username santa. There are many ways to complete a bruteforce attack. We will use the tool hydra in this case. hydra -l santa -P wordlist.txt.cupp.txt 10.14.0.9 http-post-form &quot;/index.php:username=santa&amp;password=^PASS^:Incorrect login&quot; -v And the correct credentials are santa:northpole. We are in and we can see a button to download a file. We can see a new username: elf-manager. Maybe we can use it to login with SSH. But let’s first decrypt the MD5 hashes with md5decrypt.net. What if we try reusing the password northpole with the username elf-manager? We can try to connect to SSH and see if we can get in. It works 🎉. Now that we are inside the machine you need to do some things to ensure smooth operation: export TERM=xterm This will allow us to clean the screen with ctrl + l. Now we can see the flag 🎉. Privilege escalation 🚩: We need to enumerate the system to find a way to escalate privileges. One thing I always check first is sudo -l. This command helps us determine if we have the ability to execute commands as other user. If we are lucky, we might discover that we can execute commands with the privileges of the root user. More info about privilege escalation techniques check here. We can execute vim command as the root user. We can see in GTFOBins for a way to escalate privileges. Or we can do it this way: sudo vim esc + : + !bash --&gt; This is to spawn a shell as root user. And now we are root :) Hope you like it and learn something new :)","headline":"Santa’s List","mainEntityOfPage":{"@type":"WebPage","@id":"https://fmf-x0.github.io/parrot-ctf/Santa's-list"},"url":"https://fmf-x0.github.io/parrot-ctf/Santa's-list"}</script> <!-- End Jekyll SEO tag --> <link rel="shortcut icon" href="/favicon.ico" type="image/icon"> <link rel="icon" href="/favicon.ico" type="image/icon"> <!-- stylesheets --> <link rel="stylesheet" type="text/css" href="/assets/css/base.css"> <link rel="stylesheet" type="text/css" href="/assets/css/simplePagination.css"> <link rel="stylesheet" type="text/css" href="/assets/css/highlight-theme.css"> <link rel="stylesheet" type="text/css" href="/assets/css/rouge-code.css"> <link rel="stylesheet" type="text/css" href="/assets/css/post.css"> <!-- javascripts --> <script type="text/javascript" src="/assets/js/jquery.js"></script> <!--[if lt IE 9]> <script src="/assets/js/html5shiv.js"></script> <![endif]--> </head> <!-- bare layout means not header and footer like resume --> <body> <header id="l-header"> <div class="container"> <div class="row navicon"> <a href=""><i class="fa fa-navicon"></i></a> </div> <div class="row navbar"> <nav class="col-lg-8 col-md-8 col-xs-12"> <ul class="row"> <li class="col-lg-3"><a href="/">HOME</a></li> <li class="col-lg-3"> <ul class="subnav"> <a href="javascript:void(0)">POST</a> <li><a href="/category">CATEGORY</a></li> <li><a href="/tag">TAG</a></li> </ul> </li> <li class="col-lg-3"><a href="/about">ABOUT</a></li> </ul> </nav> <div class="search col-lg-4 col-md-4 col-xs-12"> <form> <label for="search"></label> <input id="search-input" name="serach" type="text" placeholder="Search Blog Posts..."> <i class="fa fa-search"></i> </form> </div> </div> </div> </header> <section id="l-main"> <div class="container"> <div id="search-result-wrapper" class="hidden"> <h3>Search Results:</h3> <div id="search-result"></div> </div> <style> #search-result-wrapper { font-size: 2rem; background-color: #eee; padding: 5rem; padding-left: 31rem; margin-top: 1rem; margin-bottom: 1rem; box-shadow: 0 0 10px #999; border-radius: 5px; background: white; } #search-result { padding-left: 3rem; } @media (max-width: 1200px) { #search-result-wrapper { font-size: 1.7rem; padding: 2rem; } #search-result { padding-left: 1rem; } } @media (max-width: 768px) { #search-result-wrapper { margin-top: 24rem !important; } } </style> <script> $(document).ready(function() { input = $("#search-input"); wrapper = $("#search-result-wrapper"); wrapper.hide(); wrapper.removeClass("hidden"); input.on("keyup change", function() { if (! input.val()) { wrapper.slideUp("ease"); } else { wrapper.slideDown("ease"); } }); }); </script> <script src="/assets/js/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-result'), json: "/search.json" }); </script> <div class="row"> <div id="markdown-container" class="col-lg-12"> <header> <p id="post-title">Santa's list</p> <ul class="tags clearfix"> <li><i class="fa fa-tag"></i> Parrot-CTF</li> <li><i class="fa fa-tag"></i> Easy</li> </ul> </header> <p><img src="/assets/img/santa-list/1.jpg" width="800" /></p> <p><a href="https://parrot-ctfs.com/">🦜 Parrot CTFs</a> is an advanced cybersecurity education platform and Capture The Flag provider. Their goal is to create the most realistic Capture The Flag challenges and demonstrate real-world attack scenarios.</p> <h1 id="content">Content:</h1> <ul> <li><a href="#enumeration-">Enumeration</a></li> <li><a href="#initial-access-">Initial access</a></li> <li><a href="#privilege-escalation-">Privilege escalation</a></li> </ul> <h1 id="enumeration-">Enumeration 🔎:</h1> <p>We start by using <code class="language-plaintext highlighter-rouge">ping</code> to check the TTL of the machine to determine the OS we are dealing with.</p> <p><img src="/assets/img/santa-list/2.png" width="600" /></p> <p>Based on the TTL value of 63, we can determine that the machine is running a Linux machine. However, this is not for sure, but it gives us an idea. For more information, you can view: <a href="https://ostechnix.com/identify-operating-system-ttl-ping/">Identify OS using TTL value</a>.</p> <p>Now, let’s go with an nmap scan to view the open ports.</p> <p><code class="language-plaintext highlighter-rouge">sudo nmap -p- --open -sS --min-rate 5000 -n -v -Pn 10.14.0.9 -oN allPorts</code></p> <p><code class="language-plaintext highlighter-rouge">-p-</code> –&gt; We are doing a scan against all 65535 ports to search for open ports.</p> <p><code class="language-plaintext highlighter-rouge">--open</code> –&gt; It will only report open ports.</p> <p><code class="language-plaintext highlighter-rouge">-sS</code> –&gt; It can be performed quickly, scanning thousands of ports per second.</p> <p><code class="language-plaintext highlighter-rouge">--min-rate 5000</code> –&gt; It sets the minimum rate of packets sent per second to 5000.</p> <p><code class="language-plaintext highlighter-rouge">-n</code> –&gt; Tells Nmap to never do reverse DNS resolution on the active IP addresses it finds.</p> <p><code class="language-plaintext highlighter-rouge">-v</code> –&gt; It will be verbose in its output.</p> <p><code class="language-plaintext highlighter-rouge">-Pn</code> –&gt; This option skips the host discovery stage.</p> <p><code class="language-plaintext highlighter-rouge">-oN</code> –&gt; It will save the output in a file called “allPorts”.</p> <p>We find out the following open ports:</p> <p><img src="/assets/img/santa-list/3.png" width="250" /></p> <p>Let’s take a look at what the page has.</p> <p><img src="/assets/img/santa-list/4.png" width="600" /></p> <p>We can see a login panel that has some information that we can use. The login panel says <code class="language-plaintext highlighter-rouge">Santa's administration panel</code>, so maybe a valid username can be <code class="language-plaintext highlighter-rouge">santa</code>.</p> <h1 id="initial-access-">Initial access 🔑:</h1> <p>We can try common credentials like <code class="language-plaintext highlighter-rouge">admin:admin</code> or <code class="language-plaintext highlighter-rouge">root:root</code> and many others… But let’s try with the information that we have <code class="language-plaintext highlighter-rouge">santa:santa</code>, <code class="language-plaintext highlighter-rouge">santa:admin</code> or <code class="language-plaintext highlighter-rouge">santa:northpole</code> and with those credentials, we can gain access…</p> <p>But let’s try other ways rather than guessing. For example, we can use the tool cewl to create a wordlist based on the content of the page.</p> <p><code class="language-plaintext highlighter-rouge">cewl http://10.14.0.9/ --lowercase -w wordlist.txt</code></p> <p><img src="/assets/img/santa-list/5.png" width="600" /></p> <p>We can use the tool <a>cupp</a> to generate different variations of words.</p> <p><code class="language-plaintext highlighter-rouge">./cupp -w wordlist.txt</code> –&gt; We pass the wordlist that we created with <a>cewl</a>.</p> <p><img src="/assets/img/santa-list/6.png" width="600" /></p> <p>The content of the <code class="language-plaintext highlighter-rouge">wordlist.txt.cupp.txt</code> file generated by cupp is as follows:</p> <p><img src="/assets/img/santa-list/7.png" width="600" /></p> <p>We can see that it generates a lot of variations.</p> <p>Now let’s do a bruteforce attack with the use of wordlist that we have and let’s try with the username <code class="language-plaintext highlighter-rouge">santa</code>.</p> <p>There are many ways to complete a bruteforce attack. We will use the tool <a>hydra</a> in this case.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hydra -l santa -P wordlist.txt.cupp.txt 10.14.0.9 http-post-form "/index.php:username=santa&amp;password=^PASS^:Incorrect login" -v
</code></pre></div></div> <p><img src="/assets/img/santa-list/8.png" width="700" /></p> <p>And the correct credentials are <a>santa:northpole</a>.</p> <p><img src="/assets/img/santa-list/9.png" width="600" /></p> <p>We are in and we can see a button to download a file.</p> <p><img src="/assets/img/santa-list/10.png" width="600" /></p> <p>We can see a new username: <a>elf-manager</a>. Maybe we can use it to login with SSH.</p> <p>But let’s first decrypt the MD5 hashes with <a href="https://md5decrypt.net/en/">md5decrypt.net</a>.</p> <p><img src="/assets/img/santa-list/11.png" width="600" /></p> <p>What if we try reusing the password <code class="language-plaintext highlighter-rouge">northpole</code> with the username <code class="language-plaintext highlighter-rouge">elf-manager</code>? We can try to connect to SSH and see if we can get in.</p> <p><img src="/assets/img/santa-list/12.png" width="600" /></p> <p>It works 🎉. Now that we are inside the machine you need to do some things to ensure smooth operation:</p> <ol> <li><code class="language-plaintext highlighter-rouge">export TERM=xterm</code></li> </ol> <p>This will allow us to clean the screen with <code class="language-plaintext highlighter-rouge">ctrl + l</code>.</p> <p>Now we can see the flag 🎉.</p> <h1 id="privilege-escalation-">Privilege escalation 🚩:</h1> <p>We need to enumerate the system to find a way to escalate privileges.</p> <p>One thing I always check first is <a>sudo -l</a>. This command helps us determine if we have the ability to execute commands as other user. If we are lucky, we might discover that we can execute commands with the privileges of the root user.</p> <p>More info about privilege escalation techniques check <a href="https://book.hacktricks.xyz/linux-hardening/privilege-escalation">here</a>.</p> <p><img src="/assets/img/santa-list/13.png" width="600" /></p> <p>We can execute vim command as the root user. We can see in <a href="https://gtfobins.github.io/gtfobins/vim/">GTFOBins</a> for a way to escalate privileges.</p> <p>Or we can do it this way:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo vim

esc + : + !bash --&gt; This is to spawn a shell as root user.
</code></pre></div></div> <p><img src="/assets/img/santa-list/14.png" width="100" /></p> <p>And now we are root :)</p> <p><img src="/assets/img/santa-list/15.png" width="300" /></p> <p>Hope you like it and learn something new :)</p> </div> </div> </div> </section> <style> footer { text-align: center; padding: 20px; /* Optional: Add padding for spacing */ color: #fff; /* Optional: Set text color */ } </style> <footer> <h3>Made with ❤️ by <span style="color: #cf0;">FmF</span></h3> </footer> </body> </html>
