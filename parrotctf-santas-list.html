<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>Santa's List</title><!-- Begin Jekyll SEO tag v2.7.1 -->
<meta name="generator" content="Jekyll v3.9.3" />
<meta property="og:title" content="Santa‚Äôs List" />
<meta name="author" content="FmF" />
<meta property="og:locale" content="en_US" />
<link rel="canonical" href="http://localhost:4000/parrotctf-santas-list.html" />
<meta property="og:url" content="http://localhost:4000/parrotctf-santas-list.html" />
<meta property="og:site_name" content="FmF - Hacking blog ü©ª" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-08-30T00:00:00-06:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Santa‚Äôs List" />
<script type="application/ld+json">
{"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/parrotctf-santas-list.html"},"author":{"@type":"Person","name":"FmF"},"@type":"BlogPosting","url":"http://localhost:4000/parrotctf-santas-list.html","headline":"Santa‚Äôs List","dateModified":"2023-08-30T00:00:00-06:00","datePublished":"2023-08-30T00:00:00-06:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="FmF - Hacking blog ü©ª" /><link rel="shortcut icon" type="image/x-icon" href="/logo.png" />
  <link rel="stylesheet" href="/assets/css/main.css" />
</head><body a="dark">
    <main class="page-content" aria-label="Content">
      <div class="w">
        <a href="/">../</a><article>
  <p class="post-meta">
    <time datetime="2023-08-30 00:00:00 -0600">2023-08-30</time>
  </p>
  
  <h1>Santa's List</h1>

  <p><img src="/assets/img/santa-list/1.jpg" width="800" /></p>

<p><a href="https://parrot-ctfs.com/">ü¶ú Parrot CTFs</a> is an advanced cybersecurity education platform and Capture The Flag provider. Their goal is to create the most realistic Capture The Flag challenges and demonstrate real-world attack scenarios.</p>

<h1 id="content">Content:</h1>

<ul>
  <li><a href="#enumeration-">Enumeration</a></li>
  <li><a href="#initial-access-">Initial access</a></li>
  <li><a href="#privilege-escalation-">Privilege escalation</a></li>
</ul>

<h1 id="enumeration-">Enumeration üîé:</h1>

<p>We start by using <code class="language-plaintext highlighter-rouge">ping</code> to check the TTL of the machine to determine the OS we are dealing with.</p>

<p><img src="/assets/img/santa-list/2.png" width="600" /></p>

<p>Based on the TTL value of 63, we can determine that the machine is running a Linux machine. However, this is not for sure, but it gives us an idea. For more information, you can view: <a href="https://ostechnix.com/identify-operating-system-ttl-ping/">Identify OS using TTL value</a>.</p>

<p>Now, let‚Äôs go with an nmap scan to view the open ports.</p>

<p><code class="language-plaintext highlighter-rouge">sudo nmap -p- --open -sS --min-rate 5000 -n -v -Pn 10.14.0.9 -oN allPorts</code></p>

<p><code class="language-plaintext highlighter-rouge">-p-</code> ‚Äì&gt; We are doing a scan against all 65535 ports to search for open ports.</p>

<p><code class="language-plaintext highlighter-rouge">--open</code> ‚Äì&gt; It will only report open ports.</p>

<p><code class="language-plaintext highlighter-rouge">-sS</code> ‚Äì&gt; It can be performed quickly, scanning thousands of ports per second.</p>

<p><code class="language-plaintext highlighter-rouge">--min-rate 5000</code> ‚Äì&gt; It sets the minimum rate of packets sent per second to 5000.</p>

<p><code class="language-plaintext highlighter-rouge">-n</code> ‚Äì&gt; Tells Nmap to never do reverse DNS resolution on the active IP addresses it finds.</p>

<p><code class="language-plaintext highlighter-rouge">-v</code> ‚Äì&gt; It will be verbose in its output.</p>

<p><code class="language-plaintext highlighter-rouge">-Pn</code> ‚Äì&gt; This option skips the host discovery stage.</p>

<p><code class="language-plaintext highlighter-rouge">-oN</code> ‚Äì&gt; It will save the output in a file called ‚ÄúallPorts‚Äù.</p>

<p>We find out the following open ports:</p>

<p><img src="/assets/img/santa-list/3.png" width="250" /></p>

<p>Let‚Äôs take a look at what the page has.</p>

<p><img src="/assets/img/santa-list/4.png" width="600" /></p>

<p>We can see a login panel that has some information that we can use. The login panel says <code class="language-plaintext highlighter-rouge">Santa's administration panel</code>, so maybe a valid username can be <code class="language-plaintext highlighter-rouge">santa</code>.</p>

<h1 id="initial-access-">Initial access üîë:</h1>

<p>We can try common credentials like <code class="language-plaintext highlighter-rouge">admin:admin</code> or <code class="language-plaintext highlighter-rouge">root:root</code> and many others‚Ä¶ But let‚Äôs try with the information that we have <code class="language-plaintext highlighter-rouge">santa:santa</code>, <code class="language-plaintext highlighter-rouge">santa:admin</code> or <code class="language-plaintext highlighter-rouge">santa:northpole</code> and with those credentials, we can gain access‚Ä¶</p>

<p>But let‚Äôs try other ways rather than guessing. For example, we can use the tool cewl to create a wordlist based on the content of the page.</p>

<p><code class="language-plaintext highlighter-rouge">cewl http://10.14.0.9/ --lowercase -w wordlist.txt</code></p>

<p><img src="/assets/img/santa-list/5.png" width="600" /></p>

<p>We can use the tool <a>cupp</a> to generate different variations of words.</p>

<p><code class="language-plaintext highlighter-rouge">./cupp -w wordlist.txt</code> ‚Äì&gt; We pass the wordlist that we created with <a>cewl</a>.</p>

<p><img src="/assets/img/santa-list/6.png" width="600" /></p>

<p>The content of the <code class="language-plaintext highlighter-rouge">wordlist.txt.cupp.txt</code> file generated by cupp is as follows:</p>

<p><img src="/assets/img/santa-list/7.png" width="600" /></p>

<p>We can see that it generates a lot of variations.</p>

<p>Now let‚Äôs do a bruteforce attack with the use of wordlist that we have and let‚Äôs try with the username <code class="language-plaintext highlighter-rouge">santa</code>.</p>

<p>There are many ways to complete a bruteforce attack. We will use the tool <a>hydra</a> in this case.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hydra -l santa -P wordlist.txt.cupp.txt 10.14.0.9 http-post-form "/index.php:username=santa&amp;password=^PASS^:Incorrect login" -v
</code></pre></div></div>

<p><img src="/assets/img/santa-list/8.png" width="700" /></p>

<p>And the correct credentials are <a>santa:northpole</a>.</p>

<p><img src="/assets/img/santa-list/9.png" width="600" /></p>

<p>We are in and we can see a button to download a file.</p>

<p><img src="/assets/img/santa-list/10.png" width="600" /></p>

<p>We can see a new username: <a>elf-manager</a>. Maybe we can use it to login with SSH.</p>

<p>But let‚Äôs first decrypt the MD5 hashes with <a href="https://md5decrypt.net/en/">md5decrypt.net</a>.</p>

<p><img src="/assets/img/santa-list/11.png" width="600" /></p>

<p>What if we try reusing the password <code class="language-plaintext highlighter-rouge">northpole</code> with the username <code class="language-plaintext highlighter-rouge">elf-manager</code>? We can try to connect to SSH and see if we can get in.</p>

<p><img src="/assets/img/santa-list/12.png" width="600" /></p>

<p>It works üéâ. Now that we are inside the machine you need to do some things to ensure smooth operation:</p>

<ol>
  <li><code class="language-plaintext highlighter-rouge">export TERM=xterm</code></li>
</ol>

<p>This will allow us to clean the screen with <code class="language-plaintext highlighter-rouge">ctrl + l</code>.</p>

<p>Now we can see the flag üéâ.</p>

<h1 id="privilege-escalation-">Privilege escalation üö©:</h1>

<p>We need to enumerate the system to find a way to escalate privileges.</p>

<p>One thing I always check first is <a>sudo -l</a>. This command helps us determine if we have the ability to execute commands as other user. If we are lucky, we might discover that we can execute commands with the privileges of the root user.</p>

<p>More info about privilege escalation techniques check <a href="https://book.hacktricks.xyz/linux-hardening/privilege-escalation">here</a>.</p>

<p><img src="/assets/img/santa-list/13.png" width="600" /></p>

<p>We can execute vim command as the root user. We can see in <a href="https://gtfobins.github.io/gtfobins/vim/">GTFOBins</a> for a way to escalate privileges.</p>

<p>Or we can do it this way:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo vim

esc + : + !bash --&gt; This is to spawn a shell as root user.
</code></pre></div></div>

<p><img src="/assets/img/santa-list/14.png" width="100" /></p>

<p>And now we are root :)</p>

<p><img src="/assets/img/santa-list/15.png" width="300" /></p>

<p>Hope you like it and learn something new :)</p>

</article>
      </div>
    </main>
  </body>
</html>